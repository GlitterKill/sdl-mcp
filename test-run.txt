
> sdl-mcp@0.5.1 test
> node scripts/run-tests.mjs

TAP version 13
# [WARN] Invalid maxHops value, using default of 3 {"maxHops":0}
# [WARN] Invalid maxHops value, using default of 3 {"maxHops":-1}
# Subtest: BlastRadius Edge Cases
    # Subtest: maxHops validation
        # Subtest: should handle maxHops=0 gracefully (AC1)
        ok 1 - should handle maxHops=0 gracefully (AC1)
          ---
          duration_ms: 1.219
          type: 'test'
          ...
        # Subtest: should handle negative maxHops gracefully
        ok 2 - should handle negative maxHops gracefully
          ---
          duration_ms: 0.1307
          type: 'test'
          ...
        1..2
    ok 1 - maxHops validation
      ---
      duration_ms: 1.668
      type: 'suite'
      ...
    # Subtest: edge case combinations
        # Subtest: should handle empty changed symbols list
        ok 1 - should handle empty changed symbols list
          ---
          duration_ms: 0.1286
          type: 'test'
          ...
        # Subtest: should handle graph with no edges
        ok 2 - should handle graph with no edges
          ---
          duration_ms: 0.0752
          type: 'test'
          ...
        1..2
    ok 2 - edge case combinations
      ---
      duration_ms: 0.2722
      type: 'suite'
      ...
    # Subtest: missing symbol handling
        # Subtest: should handle missing symbol in graph gracefully (AC2)
        ok 1 - should handle missing symbol in graph gracefully (AC2)
          ---
          duration_ms: 0.1313
          type: 'test'
          ...
        # Subtest: should handle mix of present and missing symbols
        ok 2 - should handle mix of present and missing symbols
          ---
          duration_ms: 0.1171
          type: 'test'
          ...
        1..2
    ok 3 - missing symbol handling
      ---
      duration_ms: 0.3957
      type: 'suite'
      ...
    1..3
ok 1 - BlastRadius Edge Cases
  ---
  duration_ms: 2.5935
  type: 'suite'
  ...
# Subtest: LRU Cache
    # Subtest: Basic cache operations
        # Subtest: should store and retrieve values
        ok 1 - should store and retrieve values
          ---
          duration_ms: 0.4901
          type: 'test'
          ...
        # Subtest: should return undefined for non-existent keys
        ok 2 - should return undefined for non-existent keys
          ---
          duration_ms: 0.0638
          type: 'test'
          ...
        # Subtest: should update existing values
        ok 3 - should update existing values
          ---
          duration_ms: 0.0697
          type: 'test'
          ...
        # Subtest: should check key existence
        ok 4 - should check key existence
          ---
          duration_ms: 0.074
          type: 'test'
          ...
        1..4
    ok 1 - Basic cache operations
      ---
      duration_ms: 1.1063
      type: 'suite'
      ...
    # Subtest: Version-based invalidation
        # Subtest: should not return values from different versions
        ok 1 - should not return values from different versions
          ---
          duration_ms: 0.0728
          type: 'test'
          ...
        # Subtest: should invalidate all entries for a specific version
        ok 2 - should invalidate all entries for a specific version
          ---
          duration_ms: 0.1689
          type: 'test'
          ...
        1..2
    ok 2 - Version-based invalidation
      ---
      duration_ms: 0.3049
      type: 'suite'
      ...
    # Subtest: LRU eviction
        # Subtest: should evict least recently used entry when max entries reached
        ok 1 - should evict least recently used entry when max entries reached
          ---
          duration_ms: 0.1935
          type: 'test'
          ...
        # Subtest: should update access order on get
        ok 2 - should update access order on get
          ---
          duration_ms: 0.1177
          type: 'test'
          ...
        1..2
    ok 3 - LRU eviction
      ---
      duration_ms: 0.4168
      type: 'suite'
      ...
    # Subtest: Cache statistics
        # Subtest: should track hits and misses
        ok 1 - should track hits and misses
          ---
          duration_ms: 0.1359
          type: 'test'
          ...
        # Subtest: should track evictions
        ok 2 - should track evictions
          ---
          duration_ms: 0.1535
          type: 'test'
          ...
        # Subtest: should reset statistics
        ok 3 - should reset statistics
          ---
          duration_ms: 0.0845
          type: 'test'
          ...
        1..3
    ok 4 - Cache statistics
      ---
      duration_ms: 0.4423
      type: 'suite'
      ...
    # Subtest: Size-based eviction
        # Subtest: should evict when size limit reached
        ok 1 - should evict when size limit reached
          ---
          duration_ms: 0.0808
          type: 'test'
          ...
        1..1
    ok 5 - Size-based eviction
      ---
      duration_ms: 0.1137
      type: 'suite'
      ...
    # Subtest: Cache clearing
        # Subtest: should clear all entries
        ok 1 - should clear all entries
          ---
          duration_ms: 0.0661
          type: 'test'
          ...
        1..1
    ok 6 - Cache clearing
      ---
      duration_ms: 0.0913
      type: 'suite'
      ...
    1..6
ok 2 - LRU Cache
  ---
  duration_ms: 2.8516
  type: 'suite'
  ...
# Subtest: Global cache functions
    # Subtest: Cache key generation
        # Subtest: should generate symbol card cache keys
        ok 1 - should generate symbol card cache keys
          ---
          duration_ms: 0.0841
          type: 'test'
          ...
        # Subtest: should generate graph slice cache keys
        ok 2 - should generate graph slice cache keys
          ---
          duration_ms: 0.0573
          type: 'test'
          ...
        1..2
    ok 1 - Cache key generation
      ---
      duration_ms: 0.179
      type: 'suite'
      ...
    1..1
ok 3 - Global cache functions
  ---
  duration_ms: 0.2164
  type: 'suite'
  ...
# Subtest: Example Plugin Integration Tests (V06-10)
    # Subtest: AC1: Sample Plugin Indexing Tests
        # Subtest: Symbol Extraction
            # Subtest: should extract functions from .ex files
            not ok 1 - should extract functions from .ex files
              ---
              duration_ms: 1.7508
              type: 'test'
              location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:1251'
              failureType: 'hookFailed'
              error: 'Example plugin should load successfully'
              code: 'ERR_ASSERTION'
              name: 'AssertionError'
              expected: true
              actual: false
              operator: '=='
              stack: |-
                TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\integration\example-plugin.test.ts:32:14)
                async TestHook.run (node:internal/test_runner/test:1054:7)
                async Suite.runHook (node:internal/test_runner/test:965:9)
                async Test.run (node:internal/test_runner/test:1022:9)
                async Promise.all (index 0)
                async Suite.run (node:internal/test_runner/test:1442:7)
                async Promise.all (index 0)
                async Suite.run (node:internal/test_runner/test:1442:7)
                async Promise.all (index 0)
                async Suite.run (node:internal/test_runner/test:1442:7)
              ...
            # Subtest: should extract classes from .ex files
            not ok 2 - should extract classes from .ex files
              ---
              duration_ms: 0.3031
              type: 'test'
              location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:1981'
              failureType: 'hookFailed'
              error: 'Example plugin should load successfully'
              code: 'ERR_ASSERTION'
              name: 'AssertionError'
              expected: true
              actual: false
              operator: '=='
              stack: |-
                TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\integration\example-plugin.test.ts:32:14)
                async TestHook.run (node:internal/test_runner/test:1054:7)
                async Suite.runHook (node:internal/test_runner/test:965:9)
                async Test.run (node:internal/test_runner/test:1022:9)
                async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
              ...
            # Subtest: should generate golden file for symbols
            not ok 3 - should generate golden file for symbols
              ---
              duration_ms: 0.1517
              type: 'test'
              location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:2437'
              failureType: 'hookFailed'
              error: 'Example plugin should load successfully'
              code: 'ERR_ASSERTION'
              name: 'AssertionError'
              expected: true
              actual: false
              operator: '=='
              stack: |-
                TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\integration\example-plugin.test.ts:32:14)
                async TestHook.run (node:internal/test_runner/test:1054:7)
                async Suite.runHook (node:internal/test_runner/test:965:9)
                async Test.run (node:internal/test_runner/test:1022:9)
                async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
              ...
            # Subtest: should validate against golden file
            not ok 4 - should validate against golden file
              ---
              duration_ms: 0.1428
              type: 'test'
              location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:2967'
              failureType: 'hookFailed'
              error: 'Example plugin should load successfully'
              code: 'ERR_ASSERTION'
              name: 'AssertionError'
              expected: true
              actual: false
              operator: '=='
              stack: |-
                TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\integration\example-plugin.test.ts:32:14)
                async TestHook.run (node:internal/test_runner/test:1054:7)
                async Suite.runHook (node:internal/test_runner/test:965:9)
                async Test.run (node:internal/test_runner/test:1022:9)
                async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
              ...
            1..4
        not ok 1 - Symbol Extraction
          ---
          duration_ms: 2.809
          type: 'suite'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:1217'
          failureType: 'subtestsFailed'
          error: '4 subtests failed'
          code: 'ERR_TEST_FAILURE'
          stack: |-
            async Promise.all (index 0)
            async Promise.all (index 0)
          ...
        # Subtest: Import Extraction
            # Subtest: should extract imports from .ex files
            not ok 1 - should extract imports from .ex files
              ---
              duration_ms: 0.3323
              type: 'test'
              location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:3490'
              failureType: 'hookFailed'
              error: 'Example plugin should load successfully'
              code: 'ERR_ASSERTION'
              name: 'AssertionError'
              expected: true
              actual: false
              operator: '=='
              stack: |-
                TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\integration\example-plugin.test.ts:32:14)
                async TestHook.run (node:internal/test_runner/test:1054:7)
                async Suite.runHook (node:internal/test_runner/test:965:9)
                async Test.run (node:internal/test_runner/test:1022:9)
                async Promise.all (index 0)
                async Suite.run (node:internal/test_runner/test:1442:7)
                async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
              ...
            # Subtest: should generate golden file for imports
            not ok 2 - should generate golden file for imports
              ---
              duration_ms: 0.182
              type: 'test'
              location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:4121'
              failureType: 'hookFailed'
              error: 'Example plugin should load successfully'
              code: 'ERR_ASSERTION'
              name: 'AssertionError'
              expected: true
              actual: false
              operator: '=='
              stack: |-
                TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\integration\example-plugin.test.ts:32:14)
                async TestHook.run (node:internal/test_runner/test:1054:7)
                async Suite.runHook (node:internal/test_runner/test:965:9)
                async Test.run (node:internal/test_runner/test:1022:9)
                async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
              ...
            # Subtest: should validate against golden file
            not ok 3 - should validate against golden file
              ---
              duration_ms: 0.1662
              type: 'test'
              location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:4651'
              failureType: 'hookFailed'
              error: 'Example plugin should load successfully'
              code: 'ERR_ASSERTION'
              name: 'AssertionError'
              expected: true
              actual: false
              operator: '=='
              stack: |-
                TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\integration\example-plugin.test.ts:32:14)
                async TestHook.run (node:internal/test_runner/test:1054:7)
                async Suite.runHook (node:internal/test_runner/test:965:9)
                async Test.run (node:internal/test_runner/test:1022:9)
                async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
              ...
            1..3
        not ok 2 - Import Extraction
          ---
          duration_ms: 0.8228
          type: 'suite'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:3456'
          failureType: 'subtestsFailed'
          error: '3 subtests failed'
          code: 'ERR_TEST_FAILURE'
          ...
        # Subtest: Call Extraction
            # Subtest: should extract function calls from .ex files
            not ok 1 - should extract function calls from .ex files
              ---
              duration_ms: 0.1946
              type: 'test'
              location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:5172'
              failureType: 'hookFailed'
              error: 'Example plugin should load successfully'
              code: 'ERR_ASSERTION'
              name: 'AssertionError'
              expected: true
              actual: false
              operator: '=='
              stack: |-
                TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\integration\example-plugin.test.ts:32:14)
                async TestHook.run (node:internal/test_runner/test:1054:7)
                async Suite.runHook (node:internal/test_runner/test:965:9)
                async Test.run (node:internal/test_runner/test:1022:9)
                async Promise.all (index 0)
                async Suite.run (node:internal/test_runner/test:1442:7)
                async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
              ...
            # Subtest: should extract method calls
            not ok 2 - should extract method calls
              ---
              duration_ms: 0.2401
              type: 'test'
              location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:5851'
              failureType: 'hookFailed'
              error: 'Example plugin should load successfully'
              code: 'ERR_ASSERTION'
              name: 'AssertionError'
              expected: true
              actual: false
              operator: '=='
              stack: |-
                TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\integration\example-plugin.test.ts:32:14)
                async TestHook.run (node:internal/test_runner/test:1054:7)
                async Suite.runHook (node:internal/test_runner/test:965:9)
                async Test.run (node:internal/test_runner/test:1022:9)
                async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
              ...
            # Subtest: should generate golden file for calls
            not ok 3 - should generate golden file for calls
              ---
              duration_ms: 0.1585
              type: 'test'
              location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:6416'
              failureType: 'hookFailed'
              error: 'Example plugin should load successfully'
              code: 'ERR_ASSERTION'
              name: 'AssertionError'
              expected: true
              actual: false
              operator: '=='
              stack: |-
                TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\integration\example-plugin.test.ts:32:14)
                async TestHook.run (node:internal/test_runner/test:1054:7)
                async Suite.runHook (node:internal/test_runner/test:965:9)
                async Test.run (node:internal/test_runner/test:1022:9)
                async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
              ...
            # Subtest: should validate against golden file
            not ok 4 - should validate against golden file
              ---
              duration_ms: 0.1364
              type: 'test'
              location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:6998'
              failureType: 'hookFailed'
              error: 'Example plugin should load successfully'
              code: 'ERR_ASSERTION'
              name: 'AssertionError'
              expected: true
              actual: false
              operator: '=='
              stack: |-
                TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\integration\example-plugin.test.ts:32:14)
                async TestHook.run (node:internal/test_runner/test:1054:7)
                async Suite.runHook (node:internal/test_runner/test:965:9)
                async Test.run (node:internal/test_runner/test:1022:9)
                async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
              ...
            1..4
        not ok 3 - Call Extraction
          ---
          duration_ms: 0.8244
          type: 'suite'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:5140'
          failureType: 'subtestsFailed'
          error: '4 subtests failed'
          code: 'ERR_TEST_FAILURE'
          ...
        # Subtest: AC1: Graph Extraction Tests
            # Subtest: should extract complete graph data structure
            not ok 1 - should extract complete graph data structure
              ---
              duration_ms: 0.1324
              type: 'test'
              location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:7593'
              failureType: 'hookFailed'
              error: 'Example plugin should load successfully'
              code: 'ERR_ASSERTION'
              name: 'AssertionError'
              expected: true
              actual: false
              operator: '=='
              stack: |-
                TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\integration\example-plugin.test.ts:32:14)
                async TestHook.run (node:internal/test_runner/test:1054:7)
                async Suite.runHook (node:internal/test_runner/test:965:9)
                async Test.run (node:internal/test_runner/test:1022:9)
                async Promise.all (index 0)
                async Suite.run (node:internal/test_runner/test:1442:7)
                async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
              ...
            # Subtest: should maintain symbol ID references in calls
            not ok 2 - should maintain symbol ID references in calls
              ---
              duration_ms: 0.1006
              type: 'test'
              location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:8436'
              failureType: 'hookFailed'
              error: 'Example plugin should load successfully'
              code: 'ERR_ASSERTION'
              name: 'AssertionError'
              expected: true
              actual: false
              operator: '=='
              stack: |-
                TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\integration\example-plugin.test.ts:32:14)
                async TestHook.run (node:internal/test_runner/test:1054:7)
                async Suite.runHook (node:internal/test_runner/test:965:9)
                async Test.run (node:internal/test_runner/test:1022:9)
                async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
              ...
            # Subtest: should validate graph structure integrity
            not ok 3 - should validate graph structure integrity
              ---
              duration_ms: 0.0954
              type: 'test'
              location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:9020'
              failureType: 'hookFailed'
              error: 'Example plugin should load successfully'
              code: 'ERR_ASSERTION'
              name: 'AssertionError'
              expected: true
              actual: false
              operator: '=='
              stack: |-
                TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\integration\example-plugin.test.ts:32:14)
                async TestHook.run (node:internal/test_runner/test:1054:7)
                async Suite.runHook (node:internal/test_runner/test:965:9)
                async Test.run (node:internal/test_runner/test:1022:9)
                async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
              ...
            1..3
        not ok 4 - AC1: Graph Extraction Tests
          ---
          duration_ms: 0.3787
          type: 'suite'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:7549'
          failureType: 'subtestsFailed'
          error: '3 subtests failed'
          code: 'ERR_TEST_FAILURE'
          ...
        # Subtest: Adapter Metadata
            # Subtest: should expose correct language ID
            not ok 1 - should expose correct language ID
              ---
              duration_ms: 0.1211
              type: 'test'
              location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:9924'
              failureType: 'hookFailed'
              error: 'Example plugin should load successfully'
              code: 'ERR_ASSERTION'
              name: 'AssertionError'
              expected: true
              actual: false
              operator: '=='
              stack: |-
                TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\integration\example-plugin.test.ts:32:14)
                async TestHook.run (node:internal/test_runner/test:1054:7)
                async Suite.runHook (node:internal/test_runner/test:965:9)
                async Test.run (node:internal/test_runner/test:1022:9)
                async Promise.all (index 0)
                async Suite.run (node:internal/test_runner/test:1442:7)
                async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
              ...
            # Subtest: should expose correct file extensions
            not ok 2 - should expose correct file extensions
              ---
              duration_ms: 0.097
              type: 'test'
              location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:10030'
              failureType: 'hookFailed'
              error: 'Example plugin should load successfully'
              code: 'ERR_ASSERTION'
              name: 'AssertionError'
              expected: true
              actual: false
              operator: '=='
              stack: |-
                TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\integration\example-plugin.test.ts:32:14)
                async TestHook.run (node:internal/test_runner/test:1054:7)
                async Suite.runHook (node:internal/test_runner/test:965:9)
                async Test.run (node:internal/test_runner/test:1022:9)
                async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
              ...
            1..2
        not ok 5 - Adapter Metadata
          ---
          duration_ms: 0.2537
          type: 'suite'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:9891'
          failureType: 'subtestsFailed'
          error: '2 subtests failed'
          code: 'ERR_TEST_FAILURE'
          ...
        1..5
    not ok 1 - AC1: Sample Plugin Indexing Tests
      ---
      duration_ms: 5.4079
      type: 'suite'
      location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:865'
      failureType: 'subtestsFailed'
      error: '5 subtests failed'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        async Promise.all (index 0)
      ...
    1..1
not ok 4 - Example Plugin Integration Tests (V06-10)
  ---
  duration_ms: 6.155
  type: 'suite'
  location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\example-plugin.test.ts:1:464'
  failureType: 'subtestsFailed'
  error: '1 subtest failed'
  code: 'ERR_TEST_FAILURE'
  ...
# C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\external-plugin-loading.test.ts:21
#   getAdapter,
#   ^
# SyntaxError: The requested module '../../dist/indexer/adapter/registry.js' does not provide an export named 'getAdapter'
#     at ModuleJob._instantiate (node:internal/modules/esm/module_job:226:21)
#     at async ModuleJob.run (node:internal/modules/esm/module_job:335:5)
#     at async onImport.tracePromise.__proto__ (node:internal/modules/esm/loader:665:26)
#     at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
# Node.js v22.21.1
# Subtest: C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\external-plugin-loading.test.ts
not ok 4 - C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\external-plugin-loading.test.ts
  ---
  duration_ms: 183.4684
  type: 'test'
  location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\external-plugin-loading.test.ts:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: Grammar Loading Integration Tests (ML-B.1, ML-B.3)
    # Subtest: Python Grammar
        # Subtest: should load tree-sitter-python grammar
        ok 1 - should load tree-sitter-python grammar
          ---
          duration_ms: 12.6341
          type: 'test'
          ...
        # Subtest: should parse basic Python constructs
        ok 2 - should parse basic Python constructs
          ---
          duration_ms: 0.227
          type: 'test'
          ...
        1..2
    ok 1 - Python Grammar
      ---
      duration_ms: 13.1825
      type: 'suite'
      ...
    # Subtest: Go Grammar
        # Subtest: should load tree-sitter-go grammar
        ok 1 - should load tree-sitter-go grammar
          ---
          duration_ms: 4.1849
          type: 'test'
          ...
        # Subtest: should parse basic Go constructs
        ok 2 - should parse basic Go constructs
          ---
          duration_ms: 0.171
          type: 'test'
          ...
        1..2
    ok 2 - Go Grammar
      ---
      duration_ms: 4.4798
      type: 'suite'
      ...
    # Subtest: Java Grammar
        # Subtest: should load tree-sitter-java grammar
        ok 1 - should load tree-sitter-java grammar
          ---
          duration_ms: 5.4078
          type: 'test'
          ...
        # Subtest: should parse basic Java constructs
        ok 2 - should parse basic Java constructs
          ---
          duration_ms: 0.2084
          type: 'test'
          ...
        1..2
    ok 3 - Java Grammar
      ---
      duration_ms: 5.8049
      type: 'suite'
      ...
    # Subtest: C\# Grammar
        # Subtest: should load tree-sitter-c-sharp grammar
        ok 1 - should load tree-sitter-c-sharp grammar
          ---
          duration_ms: 6.0585
          type: 'test'
          ...
        # Subtest: should parse basic C\# constructs
        ok 2 - should parse basic C\# constructs
          ---
          duration_ms: 0.3141
          type: 'test'
          ...
        1..2
    ok 4 - C\# Grammar
      ---
      duration_ms: 6.5216
      type: 'suite'
      ...
    # Subtest: C Grammar
        # Subtest: should load tree-sitter-c grammar
        ok 1 - should load tree-sitter-c grammar
          ---
          duration_ms: 4.9306
          type: 'test'
          ...
        # Subtest: should parse basic C constructs
        ok 2 - should parse basic C constructs
          ---
          duration_ms: 0.2991
          type: 'test'
          ...
        1..2
    ok 5 - C Grammar
      ---
      duration_ms: 5.2932
      type: 'suite'
      ...
    # Subtest: C++ Grammar
        # Subtest: should load tree-sitter-cpp grammar
        ok 1 - should load tree-sitter-cpp grammar
          ---
          duration_ms: 6.8651
          type: 'test'
          ...
        # Subtest: should parse basic C++ constructs
        ok 2 - should parse basic C++ constructs
          ---
          duration_ms: 0.3312
          type: 'test'
          ...
        1..2
    ok 6 - C++ Grammar
      ---
      duration_ms: 7.2692
      type: 'suite'
      ...
    # Subtest: PHP Grammar
        # Subtest: should load tree-sitter-php grammar
        ok 1 - should load tree-sitter-php grammar
          ---
          duration_ms: 6.1512
          type: 'test'
          ...
        # Subtest: should parse basic PHP constructs
        ok 2 - should parse basic PHP constructs
          ---
          duration_ms: 0.3119
          type: 'test'
          ...
        1..2
    ok 7 - PHP Grammar
      ---
      duration_ms: 6.5278
      type: 'suite'
      ...
    # Subtest: Rust Grammar
        # Subtest: should load tree-sitter-rust grammar
        ok 1 - should load tree-sitter-rust grammar
          ---
          duration_ms: 6.4933
          type: 'test'
          ...
        # Subtest: should parse basic Rust constructs
        ok 2 - should parse basic Rust constructs
          ---
          duration_ms: 0.3441
          type: 'test'
          ...
        1..2
    ok 8 - Rust Grammar
      ---
      duration_ms: 6.9161
      type: 'suite'
      ...
    # Subtest: Kotlin Grammar
        # Subtest: should load tree-sitter-kotlin grammar
        ok 1 - should load tree-sitter-kotlin grammar
          ---
          duration_ms: 5.4914
          type: 'test'
          ...
        # Subtest: should parse basic Kotlin constructs
        ok 2 - should parse basic Kotlin constructs
          ---
          duration_ms: 0.2771
          type: 'test'
          ...
        1..2
    ok 9 - Kotlin Grammar
      ---
      duration_ms: 5.8389
      type: 'suite'
      ...
    # Subtest: Bash Grammar
        # Subtest: should load tree-sitter-bash grammar
        ok 1 - should load tree-sitter-bash grammar
          ---
          duration_ms: 3.8964
          type: 'test'
          ...
        # Subtest: should parse basic Bash constructs
        ok 2 - should parse basic Bash constructs
          ---
          duration_ms: 0.234
          type: 'test'
          ...
        1..2
    ok 10 - Bash Grammar
      ---
      duration_ms: 4.1965
      type: 'suite'
      ...
    # Subtest: Cross-Language Parser Reuse
        # Subtest: should allow multiple parsers with different languages
        ok 1 - should allow multiple parsers with different languages
          ---
          duration_ms: 0.1765
          type: 'test'
          ...
        # Subtest: should allow single parser to switch languages
        ok 2 - should allow single parser to switch languages
          ---
          duration_ms: 0.0976
          type: 'test'
          ...
        1..2
    ok 11 - Cross-Language Parser Reuse
      ---
      duration_ms: 0.3216
      type: 'suite'
      ...
    1..11
ok 6 - Grammar Loading Integration Tests (ML-B.1, ML-B.3)
  ---
  duration_ms: 66.9125
  type: 'suite'
  ...
# ✓ Extracted 14 symbols for symbols.java
# ✓ Extracted 7 imports for imports.java
# ✓ Extracted 16 calls for calls.java
# Subtest: Java Adapter Tests (ML-C3.x)
    # Subtest: ML-C3.1: Symbol Extraction
        # Subtest: should extract all symbols correctly
        ok 1 - should extract all symbols correctly
          ---
          duration_ms: 5.8513
          type: 'test'
          ...
        # Subtest: should extract classes with modifiers
        ok 2 - should extract classes with modifiers
          ---
          duration_ms: 1.2905
          type: 'test'
          ...
        # Subtest: should extract methods with visibility and signature
        ok 3 - should extract methods with visibility and signature
          ---
          duration_ms: 2.0975
          type: 'test'
          ...
        # Subtest: should identify constructors
        ok 4 - should identify constructors
          ---
          duration_ms: 1.3809
          type: 'test'
          ...
        # Subtest: should extract interfaces
        ok 5 - should extract interfaces
          ---
          duration_ms: 1.2474
          type: 'test'
          ...
        # Subtest: should extract enums
        ok 6 - should extract enums
          ---
          duration_ms: 1.2696
          type: 'test'
          ...
        # Subtest: should extract records
        ok 7 - should extract records
          ---
          duration_ms: 1.4081
          type: 'test'
          ...
        # Subtest: should extract fields with visibility
        ok 8 - should extract fields with visibility
          ---
          duration_ms: 1.0787
          type: 'test'
          ...
        # Subtest: should extract package as module
        ok 9 - should extract package as module
          ---
          duration_ms: 1.1844
          type: 'test'
          ...
        1..9
    ok 1 - ML-C3.1: Symbol Extraction
      ---
      duration_ms: 17.5707
      type: 'suite'
      ...
    # Subtest: ML-C3.2: Import Extraction
        # Subtest: should extract all imports correctly
        ok 1 - should extract all imports correctly
          ---
          duration_ms: 1.1025
          type: 'test'
          ...
        # Subtest: should parse single imports
        ok 2 - should parse single imports
          ---
          duration_ms: 0.6555
          type: 'test'
          ...
        # Subtest: should parse wildcard imports
        ok 3 - should parse wildcard imports
          ---
          duration_ms: 0.6575
          type: 'test'
          ...
        # Subtest: should identify static imports
        ok 4 - should identify static imports
          ---
          duration_ms: 0.7161
          type: 'test'
          ...
        1..4
    ok 2 - ML-C3.2: Import Extraction
      ---
      duration_ms: 3.2522
      type: 'suite'
      ...
    # Subtest: ML-C3.3: Call Extraction
        # Subtest: should extract all calls correctly
        ok 1 - should extract all calls correctly
          ---
          duration_ms: 3.5866
          type: 'test'
          ...
        # Subtest: should extract method calls with context
        ok 2 - should extract method calls with context
          ---
          duration_ms: 1.9097
          type: 'test'
          ...
        # Subtest: should create constructor edges for new expressions
        ok 3 - should create constructor edges for new expressions
          ---
          duration_ms: 1.8254
          type: 'test'
          ...
        # Subtest: should capture chained calls
        ok 4 - should capture chained calls
          ---
          duration_ms: 2.5108
          type: 'test'
          ...
        # Subtest: should identify this calls
        ok 5 - should identify this calls
          ---
          duration_ms: 2.1487
          type: 'test'
          ...
        # Subtest: should identify super calls
        ok 6 - should identify super calls
          ---
          duration_ms: 1.8449
          type: 'test'
          ...
        # Subtest: should resolve calls to symbols in same file
        ok 7 - should resolve calls to symbols in same file
          ---
          duration_ms: 2.6002
          type: 'test'
          ...
        1..7
    ok 3 - ML-C3.3: Call Extraction
      ---
      duration_ms: 16.6064
      type: 'suite'
      ...
    1..3
ok 7 - Java Adapter Tests (ML-C3.x)
  ---
  duration_ms: 37.6866
  type: 'suite'
  ...
# ✓ Generated 21 symbols for symbols.py
# calculateSum.signature: {
#   "params": [
#     {
#       "name": "a",
#       "type": "int"
#     },
#     {
#       "name": "b",
#       "type": "int"
#     }
#   ],
#   "returns": "int"
# }
# ✓ Generated 29 imports for imports.py
# ✓ Generated 44 calls for calls.py
# Subtest: Python Adapter Tests (ML-C1.x)
    # Subtest: ML-C1.1: Symbol Extraction
        # Subtest: should extract all symbols correctly
        ok 1 - should extract all symbols correctly
          ---
          duration_ms: 5.4074
          type: 'test'
          ...
        # Subtest: should extract functions with params and return hints
        ok 2 - should extract functions with params and return hints
          ---
          duration_ms: 1.7139
          type: 'test'
          ...
        # Subtest: should extract classes with inheritance
        ok 3 - should extract classes with inheritance
          ---
          duration_ms: 2.0623
          type: 'test'
          ...
        # Subtest: should detect visibility from naming conventions
        ok 4 - should detect visibility from naming conventions
          ---
          duration_ms: 1.5494
          type: 'test'
          ...
        # Subtest: should capture decorators
        ok 5 - should capture decorators
          ---
          duration_ms: 1.4267
          type: 'test'
          ...
        1..5
    ok 1 - ML-C1.1: Symbol Extraction
      ---
      duration_ms: 12.7094
      type: 'suite'
      ...
    # Subtest: ML-C1.2: Import Extraction
        # Subtest: should extract all imports correctly
        ok 1 - should extract all imports correctly
          ---
          duration_ms: 3.655
          type: 'test'
          ...
        # Subtest: should parse simple imports
        ok 2 - should parse simple imports
          ---
          duration_ms: 2.403
          type: 'test'
          ...
        # Subtest: should parse import with alias
        ok 3 - should parse import with alias
          ---
          duration_ms: 2.3895
          type: 'test'
          ...
        # Subtest: should parse from imports
        ok 4 - should parse from imports
          ---
          duration_ms: 2.4167
          type: 'test'
          ...
        # Subtest: should parse wildcard imports
        ok 5 - should parse wildcard imports
          ---
          duration_ms: 2.7297
          type: 'test'
          ...
        # Subtest: should identify relative imports
        ok 6 - should identify relative imports
          ---
          duration_ms: 2.3405
          type: 'test'
          ...
        1..6
    ok 2 - ML-C1.2: Import Extraction
      ---
      duration_ms: 16.2182
      type: 'suite'
      ...
    # Subtest: ML-C1.3: Call Extraction
        # Subtest: should extract all calls correctly
        ok 1 - should extract all calls correctly
          ---
          duration_ms: 7.8874
          type: 'test'
          ...
        # Subtest: should extract basic function calls
        ok 2 - should extract basic function calls
          ---
          duration_ms: 8.4462
          type: 'test'
          ...
        # Subtest: should extract method calls with receiver context
        ok 3 - should extract method calls with receiver context
          ---
          duration_ms: 6.6316
          type: 'test'
          ...
        # Subtest: should extract constructor calls
        ok 4 - should extract constructor calls
          ---
          duration_ms: 6.7199
          type: 'test'
          ...
        # Subtest: should capture decorator calls
        ok 5 - should capture decorator calls
          ---
          duration_ms: 7.4205
          type: 'test'
          ...
        # Subtest: should extract chained method calls
        ok 6 - should extract chained method calls
          ---
          duration_ms: 6.7522
          type: 'test'
          ...
        1..6
    ok 3 - ML-C1.3: Call Extraction
      ---
      duration_ms: 44.0617
      type: 'suite'
      ...
    # Subtest: ML-C1.4: Golden File Validation
        # Subtest: should match expected symbols
        ok 1 - should match expected symbols
          ---
          duration_ms: 2.0151
          type: 'test'
          ...
        # Subtest: should match expected imports
        ok 2 - should match expected imports
          ---
          duration_ms: 2.9123
          type: 'test'
          ...
        # Subtest: should match expected calls
        ok 3 - should match expected calls
          ---
          duration_ms: 7.928
          type: 'test'
          ...
        1..3
    ok 4 - ML-C1.4: Golden File Validation
      ---
      duration_ms: 12.9691
      type: 'suite'
      ...
    1..4
ok 8 - Python Adapter Tests (ML-C1.x)
  ---
  duration_ms: 86.2649
  type: 'suite'
  ...
# node:internal/modules/run_main:123
#     triggerUncaughtException(
#     ^
# Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'vitest' imported from C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\roundtrip-sync.test.ts
#     at Object.getPackageJSONURL (node:internal/modules/package_json_reader:314:9)
#     at packageResolve (node:internal/modules/esm/resolve:767:81)
#     at moduleResolve (node:internal/modules/esm/resolve:853:18)
#     at defaultResolve (node:internal/modules/esm/resolve:983:11)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at resolveBase (file:///C:/Users/glitt/AppData/Local/Temp/vibe-kanban/worktrees/ff1e-v06-11-v0-6-inte/sdl-mcp/node_modules/tsx/dist/esm/index.mjs?1770592253333:2:3744)
#     at resolveDirectory (file:///C:/Users/glitt/AppData/Local/Temp/vibe-kanban/worktrees/ff1e-v06-11-v0-6-inte/sdl-mcp/node_modules/tsx/dist/esm/index.mjs?1770592253333:2:4243)
#     at resolveTsPaths (file:///C:/Users/glitt/AppData/Local/Temp/vibe-kanban/worktrees/ff1e-v06-11-v0-6-inte/sdl-mcp/node_modules/tsx/dist/esm/index.mjs?1770592253333:2:4984)
#     at resolve (file:///C:/Users/glitt/AppData/Local/Temp/vibe-kanban/worktrees/ff1e-v06-11-v0-6-inte/sdl-mcp/node_modules/tsx/dist/esm/index.mjs?1770592253333:2:5361)
#     at nextResolve (node:internal/modules/esm/hooks:748:28) {
#   code: 'ERR_MODULE_NOT_FOUND'
# }
# Node.js v22.21.1
# Subtest: C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\roundtrip-sync.test.ts
not ok 8 - C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\roundtrip-sync.test.ts
  ---
  duration_ms: 133.6723
  type: 'test'
  location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\integration\\roundtrip-sync.test.ts:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# ✓ Extracted 58 symbols and 75 calls
#   - Function calls: 30
#   - Method calls: 33
#   - Macro calls: 12
# Subtest: Rust Adapter Tests - Call Extraction (ML2-C3.3)
    # Subtest: ML2-C3.3: Call Extraction
        # Subtest: should extract function calls with caller context
        ok 1 - should extract function calls with caller context
          ---
          duration_ms: 9.3255
          type: 'test'
          ...
        # Subtest: should extract method calls with receiver
        ok 2 - should extract method calls with receiver
          ---
          duration_ms: 5.1616
          type: 'test'
          ...
        # Subtest: should extract associated function calls (Type::func())
        ok 3 - should extract associated function calls (Type::func())
          ---
          duration_ms: 4.7575
          type: 'test'
          ...
        # Subtest: should extract macro invocations as unresolved edges
        ok 4 - should extract macro invocations as unresolved edges
          ---
          duration_ms: 4.8574
          type: 'test'
          ...
        # Subtest: should extract calls from comprehensive fixture
        ok 5 - should extract calls from comprehensive fixture
          ---
          duration_ms: 11.1261
          type: 'test'
          ...
        # Subtest: should handle chained method calls
        ok 6 - should handle chained method calls
          ---
          duration_ms: 5.1901
          type: 'test'
          ...
        # Subtest: should track caller context correctly
        ok 7 - should track caller context correctly
          ---
          duration_ms: 4.6742
          type: 'test'
          ...
        1..7
    ok 1 - ML2-C3.3: Call Extraction
      ---
      duration_ms: 45.6735
      type: 'suite'
      ...
    1..1
ok 10 - Rust Adapter Tests - Call Extraction (ML2-C3.3)
  ---
  duration_ms: 45.9809
  type: 'suite'
  ...
# ✓ Generated 25 symbols for symbols.sh
# ✓ Generated 12 imports for imports.sh
# ✓ Generated 54 calls for calls.sh
# Subtest: Shell Adapter Tests (ML2-C5.x)
    # Subtest: ML2-C5.1: Symbol Extraction
        # Subtest: should extract all symbols correctly
        ok 1 - should extract all symbols correctly
          ---
          duration_ms: 4.8516
          type: 'test'
          ...
        # Subtest: should extract functions
        ok 2 - should extract functions
          ---
          duration_ms: 1.488
          type: 'test'
          ...
        # Subtest: should extract variables with export status
        ok 3 - should extract variables with export status
          ---
          duration_ms: 1.8612
          type: 'test'
          ...
        # Subtest: should extract aliases
        ok 4 - should extract aliases
          ---
          duration_ms: 1.3386
          type: 'test'
          ...
        1..4
    ok 1 - ML2-C5.1: Symbol Extraction
      ---
      duration_ms: 10.0231
      type: 'suite'
      ...
    # Subtest: ML2-C5.2: Import Extraction
        # Subtest: should extract all imports correctly
        ok 1 - should extract all imports correctly
          ---
          duration_ms: 5.3827
          type: 'test'
          ...
        # Subtest: should parse source commands
        ok 2 - should parse source commands
          ---
          duration_ms: 4.6721
          type: 'test'
          ...
        # Subtest: should parse dot notation for sourcing
        ok 3 - should parse dot notation for sourcing
          ---
          duration_ms: 4.2758
          type: 'test'
          ...
        1..3
    ok 2 - ML2-C5.2: Import Extraction
      ---
      duration_ms: 14.5885
      type: 'suite'
      ...
    # Subtest: ML2-C5.3: Call Extraction
        # Subtest: should extract all calls correctly
        ok 1 - should extract all calls correctly
          ---
          duration_ms: 5.9446
          type: 'test'
          ...
        # Subtest: should extract basic function calls
        ok 2 - should extract basic function calls
          ---
          duration_ms: 5.7823
          type: 'test'
          ...
        # Subtest: should extract function calls with arguments
        ok 3 - should extract function calls with arguments
          ---
          duration_ms: 5.4329
          type: 'test'
          ...
        # Subtest: should detect external command calls
        ok 4 - should detect external command calls
          ---
          duration_ms: 6.0181
          type: 'test'
          ...
        # Subtest: should detect alias invocations
        ok 5 - should detect alias invocations
          ---
          duration_ms: 5.0856
          type: 'test'
          ...
        # Subtest: should capture caller context for calls inside functions
        ok 6 - should capture caller context for calls inside functions
          ---
          duration_ms: 5.0959
          type: 'test'
          ...
        # Subtest: should identify calls in global scope
        ok 7 - should identify calls in global scope
          ---
          duration_ms: 4.9542
          type: 'test'
          ...
        # Subtest: should skip source and alias definitions
        ok 8 - should skip source and alias definitions
          ---
          duration_ms: 4.9096
          type: 'test'
          ...
        1..8
    ok 3 - ML2-C5.3: Call Extraction
      ---
      duration_ms: 43.5001
      type: 'suite'
      ...
    # Subtest: ML2-C5.4: Golden File Validation
        # Subtest: should match expected symbols
        ok 1 - should match expected symbols
          ---
          duration_ms: 2.1377
          type: 'test'
          ...
        # Subtest: should match expected imports
        ok 2 - should match expected imports
          ---
          duration_ms: 4.845
          type: 'test'
          ...
        # Subtest: should match expected calls
        ok 3 - should match expected calls
          ---
          duration_ms: 5.2662
          type: 'test'
          ...
        1..3
    ok 4 - ML2-C5.4: Golden File Validation
      ---
      duration_ms: 12.3591
      type: 'suite'
      ...
    1..4
ok 11 - Shell Adapter Tests (ML2-C5.x)
  ---
  duration_ms: 80.8001
  type: 'suite'
  ...
# Subtest: collectTestRefs Caching
    # Subtest: Basic functionality
        # Subtest: should collect test references on first run
        ok 1 - should collect test references on first run
          ---
          duration_ms: 5.6098
          type: 'test'
          ...
        # Subtest: should return empty map when no test files exist
        ok 2 - should return empty map when no test files exist
          ---
          duration_ms: 1.2366
          type: 'test'
          ...
        1..2
    ok 1 - Basic functionality
      ---
      duration_ms: 7.0983
      type: 'suite'
      ...
    # Subtest: Cache invalidation
        # Subtest: should use cached results for unchanged files
        ok 1 - should use cached results for unchanged files
          ---
          duration_ms: 1.9571
          type: 'test'
          ...
        # Subtest: should re-scan modified files
        ok 2 - should re-scan modified files
          ---
          duration_ms: 1.8902
          type: 'test'
          ...
        # Subtest: should handle new files added between runs
        ok 3 - should handle new files added between runs
          ---
          duration_ms: 1.927
          type: 'test'
          ...
        1..3
    ok 2 - Cache invalidation
      ---
      duration_ms: 5.9844
      type: 'suite'
      ...
    # Subtest: Cache clearing
        # Subtest: should clear cache for specific repo
        ok 1 - should clear cache for specific repo
          ---
          duration_ms: 1.7976
          type: 'test'
          ...
        1..1
    ok 3 - Cache clearing
      ---
      duration_ms: 1.973
      type: 'suite'
      ...
    # Subtest: Multiple symbols per file
        # Subtest: should track all symbols referenced in a file
        ok 1 - should track all symbols referenced in a file
          ---
          duration_ms: 0.9643
          type: 'test'
          ...
        1..1
    ok 4 - Multiple symbols per file
      ---
      duration_ms: 1.0742
      type: 'suite'
      ...
    # Subtest: File pattern matching
        # Subtest: should match *.test.ts files
        ok 1 - should match *.test.ts files
          ---
          duration_ms: 1.1588
          type: 'test'
          ...
        # Subtest: should match *.spec.ts files
        ok 2 - should match *.spec.ts files
          ---
          duration_ms: 4.6057
          type: 'test'
          ...
        1..2
    ok 5 - File pattern matching
      ---
      duration_ms: 5.8468
      type: 'suite'
      ...
    # Subtest: Error handling
        # Subtest: should handle file read errors gracefully
        ok 1 - should handle file read errors gracefully
          ---
          duration_ms: 1.5347
          type: 'test'
          ...
        1..1
    ok 6 - Error handling
      ---
      duration_ms: 1.5935
      type: 'suite'
      ...
    1..6
ok 12 - collectTestRefs Caching
  ---
  duration_ms: 27.1373
  type: 'suite'
  ...
# ✅ Skeleton text is byte-stable across 10 runs
# ✅ Skeleton IR is byte-stable across 10 runs
# ✅ IR hashes are stable: 9e06b0bde006fd637a05e2ca04b572edd88e359100d5215f94ff7c97b1316f57
# ✅ Elided IR is deterministic: 34c7aa5c018075bc2c69a3be4109c8f3f5537fb48d9e9f3316e28ee3f82de97b
# ✅ Side-effect IR is deterministic: 8c222f5b535afe82d9780b153fc4e0286c9062f6a2c219e6bf79e31c94e9cdbb
# ✅ Complex nested IR is deterministic: ec3693d95ac5f919dc430c5e740bab82879bb275bb5f8f0a17d97c738dc14c23
# ✅ Semantically equivalent ops produce same hash: 2970634c42e03761057edc0617c9c5a713199f973d5fbeb74268276f214733ab
# ✅ Different ops produce different hashes
# ✅ Determinism results saved to tests\\results\\skeleton-determinism.json
# Subtest: Skeleton IR Determinism
    # Subtest: should produce byte-stable skeleton text across multiple runs
    ok 1 - should produce byte-stable skeleton text across multiple runs
      ---
      duration_ms: 0.982
      type: 'test'
      ...
    # Subtest: should produce byte-stable Skeleton IR across multiple runs
    ok 2 - should produce byte-stable Skeleton IR across multiple runs
      ---
      duration_ms: 0.1487
      type: 'test'
      ...
    # Subtest: should generate stable IR hashes for identical inputs
    ok 3 - should generate stable IR hashes for identical inputs
      ---
      duration_ms: 0.1181
      type: 'test'
      ...
    # Subtest: should produce deterministic results with elided blocks
    ok 4 - should produce deterministic results with elided blocks
      ---
      duration_ms: 0.1071
      type: 'test'
      ...
    # Subtest: should produce deterministic results with side-effect markers
    ok 5 - should produce deterministic results with side-effect markers
      ---
      duration_ms: 0.106
      type: 'test'
      ...
    # Subtest: should maintain hash stability across complex nested structures
    ok 6 - should maintain hash stability across complex nested structures
      ---
      duration_ms: 0.171
      type: 'test'
      ...
    # Subtest: should produce same hash for semantically equivalent operations
    ok 7 - should produce same hash for semantically equivalent operations
      ---
      duration_ms: 0.0914
      type: 'test'
      ...
    # Subtest: should produce different hashes for different operations
    ok 8 - should produce different hashes for different operations
      ---
      duration_ms: 0.1249
      type: 'test'
      ...
    # Subtest: should save determinism results for debugging
    ok 9 - should save determinism results for debugging
      ---
      duration_ms: 1.1463
      type: 'test'
      ...
    1..9
ok 13 - Skeleton IR Determinism
  ---
  duration_ms: 3.7739
  type: 'suite'
  ...
# Subtest: Skeleton Generator Unit Tests
    # Subtest: skeleton file parsing
        # Subtest: should be able to parse TypeScript files
        ok 1 - should be able to parse TypeScript files
          ---
          duration_ms: 3.221
          type: 'test'
          ...
        # Subtest: should handle parse errors gracefully
        ok 2 - should handle parse errors gracefully
          ---
          duration_ms: 2.1517
          type: 'test'
          ...
        # Subtest: should support multiple file extensions
        ok 3 - should support multiple file extensions
          ---
          duration_ms: 3.0192
          type: 'test'
          ...
        1..3
    ok 1 - skeleton file parsing
      ---
      duration_ms: 8.9082
      type: 'suite'
      ...
    # Subtest: skeleton extraction logic
        # Subtest: should preserve export statements
        ok 1 - should preserve export statements
          ---
          duration_ms: 2.2971
          type: 'test'
          ...
        # Subtest: should preserve function signatures
        ok 2 - should preserve function signatures
          ---
          duration_ms: 2.4806
          type: 'test'
          ...
        # Subtest: should preserve control flow statements
        ok 3 - should preserve control flow statements
          ---
          duration_ms: 2.4444
          type: 'test'
          ...
        # Subtest: should elide dense function bodies with // …
        ok 4 - should elide dense function bodies with // …
          ---
          duration_ms: 2.2444
          type: 'test'
          ...
        # Subtest: should preserve try-catch-finally blocks
        ok 5 - should preserve try-catch-finally blocks
          ---
          duration_ms: 2.0878
          type: 'test'
          ...
        # Subtest: should preserve for and while loops
        ok 6 - should preserve for and while loops
          ---
          duration_ms: 2.1742
          type: 'test'
          ...
        # Subtest: should handle class declarations
        ok 7 - should handle class declarations
          ---
          duration_ms: 1.981
          type: 'test'
          ...
        # Subtest: should be deterministic for same input
        ok 8 - should be deterministic for same input
          ---
          duration_ms: 2.2044
          type: 'test'
          ...
        # Subtest: should include return and throw statements
        ok 9 - should include return and throw statements
          ---
          duration_ms: 2.0591
          type: 'test'
          ...
        1..9
    ok 2 - skeleton extraction logic
      ---
      duration_ms: 20.3578
      type: 'suite'
      ...
    # Subtest: skeleton truncation
        # Subtest: should respect maxLines limit
        ok 1 - should respect maxLines limit
          ---
          duration_ms: 2.9946
          type: 'test'
          ...
        # Subtest: should respect maxTokens limit
        ok 2 - should respect maxTokens limit
          ---
          duration_ms: 3.166
          type: 'test'
          ...
        # Subtest: should not truncate when within limits
        ok 3 - should not truncate when within limits
          ---
          duration_ms: 2.768
          type: 'test'
          ...
        1..3
    ok 3 - skeleton truncation
      ---
      duration_ms: 9.0618
      type: 'suite'
      ...
    # Subtest: acceptance criteria
        # Subtest: should be deterministic for same input (AC1)
        ok 1 - should be deterministic for same input (AC1)
          ---
          duration_ms: 2.466
          type: 'test'
          ...
        # Subtest: should be cheaper than raw code (AC2)
        ok 2 - should be cheaper than raw code (AC2)
          ---
          duration_ms: 2.0519
          type: 'test'
          ...
        # Subtest: should preserve important identifiers when requested (AC3)
        ok 3 - should preserve important identifiers when requested (AC3)
          ---
          duration_ms: 2.1381
          type: 'test'
          ...
        1..3
    ok 4 - acceptance criteria
      ---
      duration_ms: 6.7529
      type: 'suite'
      ...
    1..4
ok 14 - Skeleton Generator Unit Tests
  ---
  duration_ms: 45.406
  type: 'suite'
  ...
# Subtest: Slice Cache - Cache key generation
    # Subtest: should generate consistent cache keys for identical requests
    ok 1 - should generate consistent cache keys for identical requests
      ---
      duration_ms: 5.4646
      type: 'test'
      ...
    # Subtest: should generate different cache keys for different requests
    ok 2 - should generate different cache keys for different requests
      ---
      duration_ms: 0.1074
      type: 'test'
      ...
    1..2
ok 15 - Slice Cache - Cache key generation
  ---
  duration_ms: 6.0217
  type: 'test'
  ...
# Subtest: Slice Cache - Cache operations
    # Subtest: should store and retrieve slices
    ok 1 - should store and retrieve slices
      ---
      duration_ms: 0.2456
      type: 'test'
      ...
    # Subtest: should store and retrieve slices
    ok 2 - should store and retrieve slices
      ---
      duration_ms: 0.0685
      type: 'test'
      ...
    # Subtest: should return null for non-existent keys
    ok 3 - should return null for non-existent keys
      ---
      duration_ms: 0.09
      type: 'test'
      ...
    # Subtest: should return null for expired entries
    ok 4 - should return null for expired entries
      ---
      duration_ms: 0.0817
      type: 'test'
      ...
    # Subtest: should track cache statistics
    ok 5 - should track cache statistics
      ---
      duration_ms: 0.1621
      type: 'test'
      ...
    # Subtest: should respect cache size limit
    ok 6 - should respect cache size limit
      ---
      duration_ms: 0.2464
      type: 'test'
      ...
    # Subtest: should clear all cache entries
    ok 7 - should clear all cache entries
      ---
      duration_ms: 0.1003
      type: 'test'
      ...
    1..7
ok 16 - Slice Cache - Cache operations
  ---
  duration_ms: 1.6438
  type: 'test'
  ...
# Subtest: Adapter Registry
    # Subtest: should return null for unregistered extensions
    ok 1 - should return null for unregistered extensions
      ---
      duration_ms: 0.5268
      type: 'test'
      ...
    # Subtest: should return null for unregistered language IDs
    ok 2 - should return null for unregistered language IDs
      ---
      duration_ms: 0.1472
      type: 'test'
      ...
    # Subtest: should register adapters with factory functions
    ok 3 - should register adapters with factory functions
      ---
      duration_ms: 0.1174
      type: 'test'
      ...
    # Subtest: should lazy load adapters
    ok 4 - should lazy load adapters
      ---
      duration_ms: 0.1324
      type: 'test'
      ...
    # Subtest: should return supported extensions
    ok 5 - should return supported extensions
      ---
      duration_ms: 0.2628
      type: 'test'
      ...
    # Subtest: should be case-insensitive for extensions
    ok 6 - should be case-insensitive for extensions
      ---
      duration_ms: 0.135
      type: 'test'
      ...
    # Subtest: should return language ID for registered extensions
    ok 7 - should return language ID for registered extensions
      ---
      duration_ms: 0.0583
      type: 'test'
      ...
    1..7
ok 17 - Adapter Registry
  ---
  duration_ms: 1.8979
  type: 'suite'
  ...
# Subtest: Evidence Capture
    # Subtest: Symbol Card Evidence
        # Subtest: captures symbol card evidence
        ok 1 - captures symbol card evidence
          ---
          duration_ms: 0.3771
          type: 'test'
          ...
        # Subtest: adds to evidence collection
        ok 2 - adds to evidence collection
          ---
          duration_ms: 0.0722
          type: 'test'
          ...
        1..2
    ok 1 - Symbol Card Evidence
      ---
      duration_ms: 0.7576
      type: 'suite'
      ...
    # Subtest: Skeleton Evidence
        # Subtest: captures skeleton evidence
        ok 1 - captures skeleton evidence
          ---
          duration_ms: 0.0637
          type: 'test'
          ...
        1..1
    ok 2 - Skeleton Evidence
      ---
      duration_ms: 0.103
      type: 'suite'
      ...
    # Subtest: Hot Path Evidence
        # Subtest: captures hot path evidence
        ok 1 - captures hot path evidence
          ---
          duration_ms: 0.0623
          type: 'test'
          ...
        1..1
    ok 3 - Hot Path Evidence
      ---
      duration_ms: 0.1087
      type: 'suite'
      ...
    # Subtest: Code Window Evidence
        # Subtest: captures code window evidence
        ok 1 - captures code window evidence
          ---
          duration_ms: 0.0656
          type: 'test'
          ...
        1..1
    ok 4 - Code Window Evidence
      ---
      duration_ms: 0.2252
      type: 'suite'
      ...
    # Subtest: Delta Evidence
        # Subtest: captures delta evidence
        ok 1 - captures delta evidence
          ---
          duration_ms: 0.0752
          type: 'test'
          ...
        1..1
    ok 5 - Delta Evidence
      ---
      duration_ms: 0.1267
      type: 'suite'
      ...
    # Subtest: Diagnostic Evidence
        # Subtest: captures diagnostic evidence
        ok 1 - captures diagnostic evidence
          ---
          duration_ms: 0.0536
          type: 'test'
          ...
        1..1
    ok 6 - Diagnostic Evidence
      ---
      duration_ms: 0.0807
      type: 'suite'
      ...
    # Subtest: Search Result Evidence
        # Subtest: captures search result evidence
        ok 1 - captures search result evidence
          ---
          duration_ms: 0.0539
          type: 'test'
          ...
        1..1
    ok 7 - Search Result Evidence
      ---
      duration_ms: 0.0826
      type: 'suite'
      ...
    # Subtest: Evidence Retrieval
        # Subtest: returns all evidence in chronological order
        ok 1 - returns all evidence in chronological order
          ---
          duration_ms: 0.1651
          type: 'test'
          ...
        # Subtest: returns evidence by type
        ok 2 - returns evidence by type
          ---
          duration_ms: 0.139
          type: 'test'
          ...
        # Subtest: returns empty array for unknown type
        ok 3 - returns empty array for unknown type
          ---
          duration_ms: 0.3591
          type: 'test'
          ...
        # Subtest: counts total evidence
        ok 4 - counts total evidence
          ---
          duration_ms: 0.0618
          type: 'test'
          ...
        # Subtest: counts evidence by type
        ok 5 - counts evidence by type
          ---
          duration_ms: 0.0386
          type: 'test'
          ...
        1..5
    ok 8 - Evidence Retrieval
      ---
      duration_ms: 0.8402
      type: 'suite'
      ...
    # Subtest: Evidence Summary
        # Subtest: generates evidence summary
        ok 1 - generates evidence summary
          ---
          duration_ms: 0.0688
          type: 'test'
          ...
        1..1
    ok 9 - Evidence Summary
      ---
      duration_ms: 0.0939
      type: 'suite'
      ...
    # Subtest: Evidence Reset
        # Subtest: resets evidence collection
        ok 1 - resets evidence collection
          ---
          duration_ms: 0.0645
          type: 'test'
          ...
        1..1
    ok 10 - Evidence Reset
      ---
      duration_ms: 0.0984
      type: 'suite'
      ...
    # Subtest: Evidence Timestamps
        # Subtest: assigns unique timestamps
        ok 1 - assigns unique timestamps
          ---
          duration_ms: 0.0435
          type: 'test'
          ...
        1..1
    ok 11 - Evidence Timestamps
      ---
      duration_ms: 0.0654
      type: 'suite'
      ...
    1..11
ok 18 - Evidence Capture
  ---
  duration_ms: 3.1505
  type: 'suite'
  ...
# Subtest: Orchestrator
    # Subtest: Task Orchestration
        # Subtest: orchestrates debug task successfully
        ok 1 - orchestrates debug task successfully
          ---
          duration_ms: 0.7446
          type: 'test'
          ...
        # Subtest: orchestrates review task successfully
        ok 2 - orchestrates review task successfully
          ---
          duration_ms: 0.119
          type: 'test'
          ...
        # Subtest: orchestrates implement task successfully
        ok 3 - orchestrates implement task successfully
          ---
          duration_ms: 0.0937
          type: 'test'
          ...
        # Subtest: orchestrates explain task successfully
        ok 4 - orchestrates explain task successfully
          ---
          duration_ms: 0.0869
          type: 'test'
          ...
        # Subtest: returns error for invalid task
        ok 5 - returns error for invalid task
          ---
          duration_ms: 0.1154
          type: 'test'
          ...
        1..5
    ok 1 - Task Orchestration
      ---
      duration_ms: 1.527
      type: 'suite'
      ...
    # Subtest: Result Structure
        # Subtest: includes taskId in result
        ok 1 - includes taskId in result
          ---
          duration_ms: 0.2079
          type: 'test'
          ...
        # Subtest: includes actionsTaken array
        ok 2 - includes actionsTaken array
          ---
          duration_ms: 0.091
          type: 'test'
          ...
        # Subtest: includes path with rungs
        ok 3 - includes path with rungs
          ---
          duration_ms: 0.1585
          type: 'test'
          ...
        # Subtest: includes finalEvidence array
        ok 4 - includes finalEvidence array
          ---
          duration_ms: 0.1124
          type: 'test'
          ...
        # Subtest: includes summary
        ok 5 - includes summary
          ---
          duration_ms: 0.1896
          type: 'test'
          ...
        # Subtest: includes metrics
        ok 6 - includes metrics
          ---
          duration_ms: 0.1364
          type: 'test'
          ...
        1..6
    ok 2 - Result Structure
      ---
      duration_ms: 1.4424
      type: 'suite'
      ...
    # Subtest: Task Planning
        # Subtest: plans task with valid path
        ok 1 - plans task with valid path
          ---
          duration_ms: 0.0859
          type: 'test'
          ...
        # Subtest: throws error for invalid task
        ok 2 - throws error for invalid task
          ---
          duration_ms: 0.2435
          type: 'test'
          ...
        1..2
    ok 3 - Task Planning
      ---
      duration_ms: 0.372
      type: 'suite'
      ...
    # Subtest: Path Selection
        # Subtest: selects minimal rungs for explain task
        ok 1 - selects minimal rungs for explain task
          ---
          duration_ms: 0.0869
          type: 'test'
          ...
        # Subtest: selects more rungs for debug task with diagnostics
        ok 2 - selects more rungs for debug task with diagnostics
          ---
          duration_ms: 0.2303
          type: 'test'
          ...
        1..2
    ok 4 - Path Selection
      ---
      duration_ms: 0.3608
      type: 'suite'
      ...
    # Subtest: Budget Respect
        # Subtest: respects token budget
        ok 1 - respects token budget
          ---
          duration_ms: 0.117
          type: 'test'
          ...
        # Subtest: respects duration budget
        ok 2 - respects duration budget
          ---
          duration_ms: 0.0624
          type: 'test'
          ...
        1..2
    ok 5 - Budget Respect
      ---
      duration_ms: 0.2205
      type: 'suite'
      ...
    # Subtest: Evidence Collection
        # Subtest: collects evidence during orchestration
        ok 1 - collects evidence during orchestration
          ---
          duration_ms: 0.0612
          type: 'test'
          ...
        # Subtest: evidence is empty on error
        ok 2 - evidence is empty on error
          ---
          duration_ms: 0.0389
          type: 'test'
          ...
        1..2
    ok 6 - Evidence Collection
      ---
      duration_ms: 0.1309
      type: 'suite'
      ...
    # Subtest: Error Handling
        # Subtest: handles missing repoId
        ok 1 - handles missing repoId
          ---
          duration_ms: 0.05
          type: 'test'
          ...
        # Subtest: handles missing taskText
        ok 2 - handles missing taskText
          ---
          duration_ms: 0.0329
          type: 'test'
          ...
        1..2
    ok 7 - Error Handling
      ---
      duration_ms: 0.1098
      type: 'suite'
      ...
    # Subtest: Summary Generation
        # Subtest: includes task type in summary
        ok 1 - includes task type in summary
          ---
          duration_ms: 0.0599
          type: 'test'
          ...
        # Subtest: includes success status in summary
        ok 2 - includes success status in summary
          ---
          duration_ms: 0.0432
          type: 'test'
          ...
        # Subtest: includes action count in summary
        ok 3 - includes action count in summary
          ---
          duration_ms: 0.0942
          type: 'test'
          ...
        1..3
    ok 8 - Summary Generation
      ---
      duration_ms: 0.2357
      type: 'suite'
      ...
    # Subtest: Determinism
        # Subtest: produces consistent results for same task
        ok 1 - produces consistent results for same task
          ---
          duration_ms: 0.0705
          type: 'test'
          ...
        1..1
    ok 9 - Determinism
      ---
      duration_ms: 0.1278
      type: 'suite'
      ...
    1..9
ok 19 - Orchestrator
  ---
  duration_ms: 4.9419
  type: 'suite'
  ...
# Subtest: Agent Planner
    # Subtest: Debug Task Planning
        # Subtest: plans debug task with diagnostics to include all rungs
        ok 1 - plans debug task with diagnostics to include all rungs
          ---
          duration_ms: 0.7056
          type: 'test'
          ...
        # Subtest: plans debug task with focus symbols to include three rungs
        ok 2 - plans debug task with focus symbols to include three rungs
          ---
          duration_ms: 0.0762
          type: 'test'
          ...
        # Subtest: plans debug task without focus to include two rungs
        ok 3 - plans debug task without focus to include two rungs
          ---
          duration_ms: 0.0479
          type: 'test'
          ...
        1..3
    ok 1 - Debug Task Planning
      ---
      duration_ms: 1.2011
      type: 'suite'
      ...
    # Subtest: Review Task Planning
        # Subtest: plans review task with focus symbols to include three rungs
        ok 1 - plans review task with focus symbols to include three rungs
          ---
          duration_ms: 0.0868
          type: 'test'
          ...
        # Subtest: plans review task with tests to include hot path
        ok 2 - plans review task with tests to include hot path
          ---
          duration_ms: 0.0813
          type: 'test'
          ...
        # Subtest: plans review task without options to include two rungs
        ok 3 - plans review task without options to include two rungs
          ---
          duration_ms: 0.0765
          type: 'test'
          ...
        1..3
    ok 2 - Review Task Planning
      ---
      duration_ms: 0.3206
      type: 'suite'
      ...
    # Subtest: Implement Task Planning
        # Subtest: plans implement task with focus paths to include hot path
        ok 1 - plans implement task with focus paths to include hot path
          ---
          duration_ms: 0.1068
          type: 'test'
          ...
        # Subtest: plans implement task without options to include two rungs
        ok 2 - plans implement task without options to include two rungs
          ---
          duration_ms: 0.057
          type: 'test'
          ...
        1..2
    ok 3 - Implement Task Planning
      ---
      duration_ms: 0.2598
      type: 'suite'
      ...
    # Subtest: Explain Task Planning
        # Subtest: plans explain task with focus symbols to include skeleton
        ok 1 - plans explain task with focus symbols to include skeleton
          ---
          duration_ms: 0.1473
          type: 'test'
          ...
        # Subtest: plans explain task without options to include only card
        ok 2 - plans explain task without options to include only card
          ---
          duration_ms: 0.1346
          type: 'test'
          ...
        1..2
    ok 4 - Explain Task Planning
      ---
      duration_ms: 0.3267
      type: 'suite'
      ...
    # Subtest: Budget Constraints
        # Subtest: reduces rungs when token budget is exceeded
        ok 1 - reduces rungs when token budget is exceeded
          ---
          duration_ms: 0.1184
          type: 'test'
          ...
        # Subtest: reduces rungs when duration budget is exceeded
        ok 2 - reduces rungs when duration budget is exceeded
          ---
          duration_ms: 0.0858
          type: 'test'
          ...
        # Subtest: keeps minimum one rung when budget is very low
        ok 3 - keeps minimum one rung when budget is very low
          ---
          duration_ms: 0.0423
          type: 'test'
          ...
        1..3
    ok 5 - Budget Constraints
      ---
      duration_ms: 0.2956
      type: 'suite'
      ...
    # Subtest: Context Selection
        # Subtest: selects focus symbols from options
        ok 1 - selects focus symbols from options
          ---
          duration_ms: 0.0684
          type: 'test'
          ...
        # Subtest: selects focus paths from options
        ok 2 - selects focus paths from options
          ---
          duration_ms: 0.0343
          type: 'test'
          ...
        # Subtest: selects both symbols and paths when provided
        ok 3 - selects both symbols and paths when provided
          ---
          duration_ms: 0.034
          type: 'test'
          ...
        # Subtest: returns empty context when no options provided
        ok 4 - returns empty context when no options provided
          ---
          duration_ms: 0.0237
          type: 'test'
          ...
        1..4
    ok 6 - Context Selection
      ---
      duration_ms: 0.2041
      type: 'suite'
      ...
    # Subtest: Task Validation
        # Subtest: validates task with all required fields
        ok 1 - validates task with all required fields
          ---
          duration_ms: 0.4561
          type: 'test'
          ...
        # Subtest: rejects task with empty task text
        ok 2 - rejects task with empty task text
          ---
          duration_ms: 0.0526
          type: 'test'
          ...
        # Subtest: rejects task with empty repo id
        ok 3 - rejects task with empty repo id
          ---
          duration_ms: 0.0326
          type: 'test'
          ...
        # Subtest: rejects task with negative max tokens
        ok 4 - rejects task with negative max tokens
          ---
          duration_ms: 0.0279
          type: 'test'
          ...
        # Subtest: rejects task with negative max duration
        ok 5 - rejects task with negative max duration
          ---
          duration_ms: 0.0265
          type: 'test'
          ...
        # Subtest: rejects task with negative max actions
        ok 6 - rejects task with negative max actions
          ---
          duration_ms: 0.0239
          type: 'test'
          ...
        # Subtest: validates task with valid budget constraints
        ok 7 - validates task with valid budget constraints
          ---
          duration_ms: 0.0248
          type: 'test'
          ...
        1..7
    ok 7 - Task Validation
      ---
      duration_ms: 0.7087
      type: 'suite'
      ...
    # Subtest: Path Estimation
        # Subtest: estimates tokens correctly for different rungs
        ok 1 - estimates tokens correctly for different rungs
          ---
          duration_ms: 0.0597
          type: 'test'
          ...
        # Subtest: estimates duration correctly for different rungs
        ok 2 - estimates duration correctly for different rungs
          ---
          duration_ms: 0.0333
          type: 'test'
          ...
        # Subtest: includes reasoning in path
        ok 3 - includes reasoning in path
          ---
          duration_ms: 0.026
          type: 'test'
          ...
        1..3
    ok 8 - Path Estimation
      ---
      duration_ms: 0.1521
      type: 'suite'
      ...
    1..8
ok 20 - Agent Planner
  ---
  duration_ms: 3.9302
  type: 'suite'
  ...
# node:internal/modules/run_main:123
#     triggerUncaughtException(
#     ^
# Error [TransformError]: Transform failed with 1 error:
# C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\benchmark-guardrails.test.ts:1:1: ERROR: Syntax error " "
#     at failureErrorWithLog (C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\node_modules\\esbuild\\lib\\main.js:1467:15)
#     at C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\node_modules\\esbuild\\lib\\main.js:736:50
#     at responseCallbacks.<computed> (C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\node_modules\\esbuild\\lib\\main.js:603:9)
#     at handleIncomingPacket (C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\node_modules\\esbuild\\lib\\main.js:658:12)
#     at Socket.readFromStdout (C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\node_modules\\esbuild\\lib\\main.js:581:7)
#     at Socket.emit (node:events:519:28)
#     at addChunk (node:internal/streams/readable:561:12)
#     at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
#     at Readable.push (node:internal/streams/readable:392:5)
#     at Pipe.onStreamRead (node:internal/stream_base_commons:189:23)
# Node.js v22.21.1
# Subtest: C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\benchmark-guardrails.test.ts
not ok 19 - C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\benchmark-guardrails.test.ts
  ---
  duration_ms: 136.1602
  type: 'test'
  location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\benchmark-guardrails.test.ts:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: C Adapter
    # Subtest: ML2-C1.1: Symbol Extraction
        # Subtest: should extract function definitions with parameters
        ok 1 - should extract function definitions with parameters
          ---
          duration_ms: 5.0562
          type: 'test'
          ...
        # Subtest: should extract functions with void parameters
        ok 2 - should extract functions with void parameters
          ---
          duration_ms: 2.1442
          type: 'test'
          ...
        # Subtest: should extract functions with pointer parameters
        ok 3 - should extract functions with pointer parameters
          ---
          duration_ms: 1.4897
          type: 'test'
          ...
        # Subtest: should extract struct specifiers
        ok 4 - should extract struct specifiers
          ---
          duration_ms: 1.5671
          type: 'test'
          ...
        # Subtest: should extract enum specifiers with values
        ok 5 - should extract enum specifiers with values
          ---
          duration_ms: 1.7989
          type: 'test'
          ...
        # Subtest: should extract typedef declarations
        ok 6 - should extract typedef declarations
          ---
          duration_ms: 1.3669
          type: 'test'
          ...
        # Subtest: should extract anonymous typedefs
        ok 7 - should extract anonymous typedefs
          ---
          duration_ms: 1.2614
          type: 'test'
          ...
        1..7
    ok 1 - ML2-C1.1: Symbol Extraction
      ---
      duration_ms: 15.2668
      type: 'suite'
      ...
    # Subtest: ML2-C1.2: Import Extraction
        # Subtest: should extract system includes
        ok 1 - should extract system includes
          ---
          duration_ms: 0.8019
          type: 'test'
          ...
        # Subtest: should extract local includes
        ok 2 - should extract local includes
          ---
          duration_ms: 0.6002
          type: 'test'
          ...
        # Subtest: should extract relative includes
        ok 3 - should extract relative includes
          ---
          duration_ms: 0.6062
          type: 'test'
          ...
        1..3
    ok 2 - ML2-C1.2: Import Extraction
      ---
      duration_ms: 2.1598
      type: 'suite'
      ...
    # Subtest: ML2-C1.3: Call Extraction
        # Subtest: should extract function calls
        ok 1 - should extract function calls
          ---
          duration_ms: 4.4998
          type: 'test'
          ...
        # Subtest: should extract pointer field access calls
        ok 2 - should extract pointer field access calls
          ---
          duration_ms: 4.6206
          type: 'test'
          ...
        # Subtest: should extract malloc call
        ok 3 - should extract malloc call
          ---
          duration_ms: 3.5716
          type: 'test'
          ...
        # Subtest: should extract free call
        ok 4 - should extract free call
          ---
          duration_ms: 3.7073
          type: 'test'
          ...
        1..4
    ok 3 - ML2-C1.3: Call Extraction
      ---
      duration_ms: 16.5215
      type: 'suite'
      ...
    # Subtest: ML2-C1.4: Golden Files
        # Subtest: should match expected symbols.h output
        ok 1 - should match expected symbols.h output
          ---
          duration_ms: 1.2239
          type: 'test'
          ...
        # Subtest: should match expected symbols.c output
        ok 2 - should match expected symbols.c output
          ---
          duration_ms: 1.3641
          type: 'test'
          ...
        # Subtest: should match expected imports output
        ok 3 - should match expected imports output
          ---
          duration_ms: 0.58
          type: 'test'
          ...
        # Subtest: should match expected calls output
        ok 4 - should match expected calls output
          ---
          duration_ms: 3.4065
          type: 'test'
          ...
        1..4
    ok 4 - ML2-C1.4: Golden Files
      ---
      duration_ms: 6.6883
      type: 'suite'
      ...
    # Subtest: Edge Cases
        # Subtest: should handle macros as unresolved calls
        ok 1 - should handle macros as unresolved calls
          ---
          duration_ms: 2.9293
          type: 'test'
          ...
        # Subtest: should handle function pointers
        ok 2 - should handle function pointers
          ---
          duration_ms: 2.856
          type: 'test'
          ...
        1..2
    ok 5 - Edge Cases
      ---
      duration_ms: 5.8613
      type: 'suite'
      ...
    1..5
ok 22 - C Adapter
  ---
  duration_ms: 46.9247
  type: 'suite'
  ...
# Subtest: CLI arg parsing
    # Subtest: prefers parsed --repo-id and --watch values for index command
    ok 1 - prefers parsed --repo-id and --watch values for index command
      ---
      duration_ms: 0.3358
      type: 'test'
      ...
    # Subtest: prefers parsed transport values for serve command
    ok 2 - prefers parsed transport values for serve command
      ---
      duration_ms: 0.11
      type: 'test'
      ...
    1..2
ok 23 - CLI arg parsing
  ---
  duration_ms: 0.8853
  type: 'suite'
  ...
# Subtest: Config Loading (RR-H.8)
    # Subtest: should resolve default path relative to module (RR-H.8.1)
    ok 1 - should resolve default path relative to module (RR-H.8.1)
      ---
      duration_ms: 0.328
      type: 'test'
      ...
    # Subtest: should load example config successfully
    ok 2 - should load example config successfully
      ---
      duration_ms: 1.6058
      type: 'test'
      ...
    # Subtest: should throw error for non-existent config
    ok 3 - should throw error for non-existent config
      ---
      duration_ms: 0.8441
      type: 'test'
      ...
    1..3
ok 24 - Config Loading (RR-H.8)
  ---
  duration_ms: 3.2936
  type: 'suite'
  ...
# Subtest: AsyncFs Factory Pattern (RR-H.8.2)
    # Subtest: should create new instances with factory (RR-H.8.2.1)
    ok 1 - should create new instances with factory (RR-H.8.2.1)
      ---
      duration_ms: 0.0984
      type: 'test'
      ...
    # Subtest: should apply config to each new instance (RR-H.8.2.2)
    ok 2 - should apply config to each new instance (RR-H.8.2.2)
      ---
      duration_ms: 0.0643
      type: 'test'
      ...
    # Subtest: should use default config when none provided
    ok 3 - should use default config when none provided
      ---
      duration_ms: 0.0426
      type: 'test'
      ...
    1..3
ok 25 - AsyncFs Factory Pattern (RR-H.8.2)
  ---
  duration_ms: 0.3718
  type: 'suite'
  ...
# Subtest: C++ Adapter
    # Subtest: ML2-C1.5: Symbol Extraction
        # Subtest: should extract namespace definitions
        ok 1 - should extract namespace definitions
          ---
          duration_ms: 8.1941
          type: 'test'
          ...
        # Subtest: should extract class specifiers
        ok 2 - should extract class specifiers
          ---
          duration_ms: 2.2313
          type: 'test'
          ...
        # Subtest: should extract constructors from headers
        ok 3 - should extract constructors from headers
          ---
          duration_ms: 2.0589
          type: 'test'
          ...
        # Subtest: should extract destructors
        ok 4 - should extract destructors
          ---
          duration_ms: 2.308
          type: 'test'
          ...
        # Subtest: should extract methods
        ok 5 - should extract methods
          ---
          duration_ms: 4.4047
          type: 'test'
          ...
        # Subtest: should extract template classes
        ok 6 - should extract template classes
          ---
          duration_ms: 2.1113
          type: 'test'
          ...
        # Subtest: should extract enum specifiers
        ok 7 - should extract enum specifiers
          ---
          duration_ms: 2.0764
          type: 'test'
          ...
        # Subtest: should extract alias declarations (using)
        ok 8 - should extract alias declarations (using)
          ---
          duration_ms: 1.8848
          type: 'test'
          ...
        # Subtest: should extract free functions
        ok 9 - should extract free functions
          ---
          duration_ms: 2.8684
          type: 'test'
          ...
        # Subtest: should extract symbols in anonymous namespace
        ok 10 - should extract symbols in anonymous namespace
          ---
          duration_ms: 3.1241
          type: 'test'
          ...
        # Subtest: should extract symbols in inline namespace
        ok 11 - should extract symbols in inline namespace
          ---
          duration_ms: 5.2138
          type: 'test'
          ...
        1..11
    ok 1 - ML2-C1.5: Symbol Extraction
      ---
      duration_ms: 37.2518
      type: 'suite'
      ...
    # Subtest: ML2-C1.6: Import Extraction
        # Subtest: should extract system includes
        ok 1 - should extract system includes
          ---
          duration_ms: 0.8683
          type: 'test'
          ...
        # Subtest: should extract local includes
        ok 2 - should extract local includes
          ---
          duration_ms: 0.5365
          type: 'test'
          ...
        # Subtest: should extract relative includes
        ok 3 - should extract relative includes
          ---
          duration_ms: 0.5221
          type: 'test'
          ...
        1..3
    ok 2 - ML2-C1.6: Import Extraction
      ---
      duration_ms: 2.0182
      type: 'suite'
      ...
    # Subtest: ML2-C1.7: Call Extraction
        # Subtest: should extract method calls
        ok 1 - should extract method calls
          ---
          duration_ms: 2.8204
          type: 'test'
          ...
        # Subtest: should extract free function calls
        ok 2 - should extract free function calls
          ---
          duration_ms: 2.3029
          type: 'test'
          ...
        # Subtest: should extract constructor calls (new)
        ok 3 - should extract constructor calls (new)
          ---
          duration_ms: 2.2085
          type: 'test'
          ...
        # Subtest: should extract template function calls
        ok 4 - should extract template function calls
          ---
          duration_ms: 4.2955
          type: 'test'
          ...
        # Subtest: should extract method calls on objects
        ok 5 - should extract method calls on objects
          ---
          duration_ms: 2.6472
          type: 'test'
          ...
        # Subtest: should extract std library method calls
        ok 6 - should extract std library method calls
          ---
          duration_ms: 2.3187
          type: 'test'
          ...
        1..6
    ok 3 - ML2-C1.7: Call Extraction
      ---
      duration_ms: 16.7551
      type: 'suite'
      ...
    # Subtest: Golden Files
        # Subtest: should match expected symbols.hpp output
        ok 1 - should match expected symbols.hpp output
          ---
          duration_ms: 2.1933
          type: 'test'
          ...
        # Subtest: should match expected symbols.cpp output
        ok 2 - should match expected symbols.cpp output
          ---
          duration_ms: 3.1549
          type: 'test'
          ...
        # Subtest: should match expected imports.cpp output
        ok 3 - should match expected imports.cpp output
          ---
          duration_ms: 0.7189
          type: 'test'
          ...
        # Subtest: should match expected calls.cpp output
        ok 4 - should match expected calls.cpp output
          ---
          duration_ms: 4.1338
          type: 'test'
          ...
        1..4
    ok 4 - Golden Files
      ---
      duration_ms: 10.3809
      type: 'suite'
      ...
    # Subtest: Integration
        # Subtest: should handle complete C++ file with all constructs
        ok 1 - should handle complete C++ file with all constructs
          ---
          duration_ms: 1.1641
          type: 'test'
          ...
        # Subtest: should handle templates with multiple type parameters
        ok 2 - should handle templates with multiple type parameters
          ---
          duration_ms: 1.5447
          type: 'test'
          ...
        1..2
    ok 5 - Integration
      ---
      duration_ms: 2.7909
      type: 'suite'
      ...
    # Subtest: Edge Cases
        # Subtest: should handle macros as unresolved calls
        ok 1 - should handle macros as unresolved calls
          ---
          duration_ms: 0.7472
          type: 'test'
          ...
        # Subtest: should handle lambda expressions
        ok 2 - should handle lambda expressions
          ---
          duration_ms: 0.781
          type: 'test'
          ...
        # Subtest: should handle operator overloading
        ok 3 - should handle operator overloading
          ---
          duration_ms: 0.8807
          type: 'test'
          ...
        1..3
    ok 6 - Edge Cases
      ---
      duration_ms: 2.4935
      type: 'suite'
      ...
    1..6
ok 26 - C++ Adapter
  ---
  duration_ms: 72.0937
  type: 'suite'
  ...
# Subtest: Cross-Platform Path Utilities
    # Subtest: normalizePath
        # Subtest: should convert Windows backslashes to forward slashes
        ok 1 - should convert Windows backslashes to forward slashes
          ---
          duration_ms: 0.4437
          type: 'test'
          ...
        # Subtest: should keep forward slashes unchanged
        ok 2 - should keep forward slashes unchanged
          ---
          duration_ms: 0.1068
          type: 'test'
          ...
        # Subtest: should handle mixed path separators
        ok 3 - should handle mixed path separators
          ---
          duration_ms: 0.053
          type: 'test'
          ...
        # Subtest: should handle empty string
        ok 4 - should handle empty string
          ---
          duration_ms: 0.0431
          type: 'test'
          ...
        # Subtest: should handle single-component paths
        ok 5 - should handle single-component paths
          ---
          duration_ms: 0.0425
          type: 'test'
          ...
        1..5
    ok 1 - normalizePath
      ---
      duration_ms: 1.1095
      type: 'suite'
      ...
    # Subtest: getRelativePath
        # Subtest: should calculate relative path on Unix-style paths
        ok 1 - should calculate relative path on Unix-style paths
          ---
          duration_ms: 0.1667
          type: 'test'
          ...
        # Subtest: should normalize result to use forward slashes
        ok 2 - should normalize result to use forward slashes
          ---
          duration_ms: 0.1698
          type: 'test'
          ...
        # Subtest: should handle same directory
        ok 3 - should handle same directory
          ---
          duration_ms: 0.1215
          type: 'test'
          ...
        # Subtest: should handle parent directory
        ok 4 - should handle parent directory
          ---
          duration_ms: 0.0896
          type: 'test'
          ...
        1..4
    ok 2 - getRelativePath
      ---
      duration_ms: 0.7758
      type: 'suite'
      ...
    # Subtest: safeJoin
        # Subtest: should join path components and normalize separators
        ok 1 - should join path components and normalize separators
          ---
          duration_ms: 0.1383
          type: 'test'
          ...
        # Subtest: should handle mixed separators in components
        ok 2 - should handle mixed separators in components
          ---
          duration_ms: 0.0439
          type: 'test'
          ...
        # Subtest: should handle absolute paths (keep them absolute)
        ok 3 - should handle absolute paths (keep them absolute)
          ---
          duration_ms: 0.0353
          type: 'test'
          ...
        # Subtest: should handle Windows absolute paths
        ok 4 - should handle Windows absolute paths
          ---
          duration_ms: 0.0798
          type: 'test'
          ...
        # Subtest: should normalize dot segments
        ok 5 - should normalize dot segments
          ---
          duration_ms: 0.0346
          type: 'test'
          ...
        1..5
    ok 3 - safeJoin
      ---
      duration_ms: 0.4022
      type: 'suite'
      ...
    # Subtest: getAbsolutePathFromRepoRoot
        # Subtest: should join repo root with relative path
        ok 1 - should join repo root with relative path
          ---
          duration_ms: 0.1684
          type: 'test'
          ...
        # Subtest: should normalize Windows paths
        ok 2 - should normalize Windows paths
          ---
          duration_ms: 0.0803
          type: 'test'
          ...
        # Subtest: should handle mixed separators
        ok 3 - should handle mixed separators
          ---
          duration_ms: 0.0789
          type: 'test'
          ...
        1..3
    ok 4 - getAbsolutePathFromRepoRoot
      ---
      duration_ms: 0.3742
      type: 'suite'
      ...
    # Subtest: Real-world Path Scenarios
        # Subtest: should handle file paths with Windows backslashes
        ok 1 - should handle file paths with Windows backslashes
          ---
          duration_ms: 0.0596
          type: 'test'
          ...
        # Subtest: should handle relative import paths with backslashes
        ok 2 - should handle relative import paths with backslashes
          ---
          duration_ms: 0.0494
          type: 'test'
          ...
        # Subtest: should handle Windows network paths
        ok 3 - should handle Windows network paths
          ---
          duration_ms: 0.0331
          type: 'test'
          ...
        # Subtest: should calculate path between two files on Windows
        ok 4 - should calculate path between two files on Windows
          ---
          duration_ms: 0.0514
          type: 'test'
          ...
        # Subtest: should handle deeply nested paths
        ok 5 - should handle deeply nested paths
          ---
          duration_ms: 0.0276
          type: 'test'
          ...
        # Subtest: should handle paths with spaces
        ok 6 - should handle paths with spaces
          ---
          duration_ms: 0.0243
          type: 'test'
          ...
        1..6
    ok 5 - Real-world Path Scenarios
      ---
      duration_ms: 0.7007
      type: 'suite'
      ...
    # Subtest: Cross-Platform Consistency
        # Subtest: should produce same normalized path from different OS inputs
        ok 1 - should produce same normalized path from different OS inputs
          ---
          duration_ms: 0.0425
          type: 'test'
          ...
        # Subtest: should produce same relative path regardless of input format
        ok 2 - should produce same relative path regardless of input format
          ---
          duration_ms: 0.0638
          type: 'test'
          ...
        # Subtest: should handle empty relative path correctly
        ok 3 - should handle empty relative path correctly
          ---
          duration_ms: 0.0233
          type: 'test'
          ...
        1..3
    ok 6 - Cross-Platform Consistency
      ---
      duration_ms: 0.1654
      type: 'suite'
      ...
    # Subtest: Edge Cases
        # Subtest: should handle trailing slashes
        ok 1 - should handle trailing slashes
          ---
          duration_ms: 0.0483
          type: 'test'
          ...
        # Subtest: should handle leading slashes in relative paths
        ok 2 - should handle leading slashes in relative paths
          ---
          duration_ms: 0.0229
          type: 'test'
          ...
        # Subtest: should handle multiple consecutive slashes
        ok 3 - should handle multiple consecutive slashes
          ---
          duration_ms: 0.0222
          type: 'test'
          ...
        # Subtest: should handle current directory references
        ok 4 - should handle current directory references
          ---
          duration_ms: 0.0216
          type: 'test'
          ...
        # Subtest: should handle parent directory references in middle of path
        ok 5 - should handle parent directory references in middle of path
          ---
          duration_ms: 0.0218
          type: 'test'
          ...
        1..5
    ok 7 - Edge Cases
      ---
      duration_ms: 0.1818
      type: 'suite'
      ...
    1..7
ok 27 - Cross-Platform Path Utilities
  ---
  duration_ms: 4.0718
  type: 'suite'
  ...
# Subtest: Go Adapter
    # Subtest: ML-C2.1: Symbol Extraction
        # Subtest: should extract package declarations
        ok 1 - should extract package declarations
          ---
          duration_ms: 5.3281
          type: 'test'
          ...
        # Subtest: should extract functions with parameters and return types
        ok 2 - should extract functions with parameters and return types
          ---
          duration_ms: 2.6367
          type: 'test'
          ...
        # Subtest: should extract methods with receiver type
        ok 3 - should extract methods with receiver type
          ---
          duration_ms: 1.9916
          type: 'test'
          ...
        # Subtest: should extract type declarations
        ok 4 - should extract type declarations
          ---
          duration_ms: 1.8868
          type: 'test'
          ...
        # Subtest: should extract const declarations
        ok 5 - should extract const declarations
          ---
          duration_ms: 2.3145
          type: 'test'
          ...
        # Subtest: should extract var declarations
        ok 6 - should extract var declarations
          ---
          duration_ms: 1.9782
          type: 'test'
          ...
        # Subtest: should export only capitalized symbols
        ok 7 - should export only capitalized symbols
          ---
          duration_ms: 2.5885
          type: 'test'
          ...
        1..7
    ok 1 - ML-C2.1: Symbol Extraction
      ---
      duration_ms: 19.2734
      type: 'suite'
      ...
    # Subtest: ML-C2.2: Import Extraction
        # Subtest: should extract single-line imports
        ok 1 - should extract single-line imports
          ---
          duration_ms: 1.6677
          type: 'test'
          ...
        # Subtest: should extract aliased imports
        ok 2 - should extract aliased imports
          ---
          duration_ms: 1.2452
          type: 'test'
          ...
        # Subtest: should identify external vs relative imports
        ok 3 - should identify external vs relative imports
          ---
          duration_ms: 1.1192
          type: 'test'
          ...
        # Subtest: should identify dot imports
        ok 4 - should identify dot imports
          ---
          duration_ms: 1.0448
          type: 'test'
          ...
        # Subtest: should identify blank imports
        ok 5 - should identify blank imports
          ---
          duration_ms: 0.8938
          type: 'test'
          ...
        1..5
    ok 2 - ML-C2.2: Import Extraction
      ---
      duration_ms: 6.1777
      type: 'suite'
      ...
    # Subtest: ML-C2.3: Call Extraction
        # Subtest: should extract function calls
        ok 1 - should extract function calls
          ---
          duration_ms: 5.6461
          type: 'test'
          ...
        # Subtest: should extract method calls
        ok 2 - should extract method calls
          ---
          duration_ms: 5.46
          type: 'test'
          ...
        # Subtest: should extract package-qualified calls
        ok 3 - should extract package-qualified calls
          ---
          duration_ms: 4.898
          type: 'test'
          ...
        # Subtest: should extract go statement calls
        ok 4 - should extract go statement calls
          ---
          duration_ms: 4.9275
          type: 'test'
          ...
        # Subtest: should extract defer statement calls
        ok 5 - should extract defer statement calls
          ---
          duration_ms: 5.4528
          type: 'test'
          ...
        1..5
    ok 3 - ML-C2.3: Call Extraction
      ---
      duration_ms: 26.5505
      type: 'suite'
      ...
    # Subtest: ML-C2.4: Golden Files
        # Subtest: should match expected symbols output
        ok 1 - should match expected symbols output
          ---
          duration_ms: 1.8039
          type: 'test'
          ...
        # Subtest: should match expected imports output
        ok 2 - should match expected imports output
          ---
          duration_ms: 1.0197
          type: 'test'
          ...
        # Subtest: should match expected calls output
        ok 3 - should match expected calls output
          ---
          duration_ms: 4.929
          type: 'test'
          ...
        1..3
    ok 4 - ML-C2.4: Golden Files
      ---
      duration_ms: 7.8611
      type: 'suite'
      ...
    # Subtest: Integration
        # Subtest: should handle complete Go file with all constructs
        ok 1 - should handle complete Go file with all constructs
          ---
          duration_ms: 4.6699
          type: 'test'
          ...
        1..1
    ok 5 - Integration
      ---
      duration_ms: 4.7335
      type: 'suite'
      ...
    1..5
ok 28 - Go Adapter
  ---
  duration_ms: 65.0149
  type: 'suite'
  ...
# Subtest: harness runner teardown
    # Subtest: stops harness before exiting success path
    ok 1 - stops harness before exiting success path
      ---
      duration_ms: 0.5631
      type: 'test'
      ...
    1..1
ok 29 - harness runner teardown
  ---
  duration_ms: 0.9493
  type: 'suite'
  ...
# Subtest: Incremental Metrics Calculation (PERF-L2.2)
    # Subtest: Full metrics update
        # Subtest: should update all symbols without changedFileIds
        ok 1 - should update all symbols without changedFileIds
          ---
          duration_ms: 8.929
          type: 'test'
          ...
        1..1
    ok 1 - Full metrics update
      ---
      duration_ms: 9.1556
      type: 'suite'
      ...
    # Subtest: Incremental metrics update
        # Subtest: should only update affected symbols for changed files
        ok 1 - should only update affected symbols for changed files
          ---
          duration_ms: 1.9316
          type: 'test'
          ...
        # Subtest: should track edge neighbors correctly
        ok 2 - should track edge neighbors correctly
          ---
          duration_ms: 1.4754
          type: 'test'
          ...
        # Subtest: should handle multiple changed files
        ok 3 - should handle multiple changed files
          ---
          duration_ms: 1.528
          type: 'test'
          ...
        1..3
    ok 2 - Incremental metrics update
      ---
      duration_ms: 5.1012
      type: 'suite'
      ...
    # Subtest: Changed files parameter
        # Subtest: should update all symbols when changedFileIds is undefined
        ok 1 - should update all symbols when changedFileIds is undefined
          ---
          duration_ms: 1.4794
          type: 'test'
          ...
        # Subtest: should not update anything with empty changedFileIds
        ok 2 - should not update anything with empty changedFileIds
          ---
          duration_ms: 0.1977
          type: 'test'
          ...
        1..2
    ok 3 - Changed files parameter
      ---
      duration_ms: 1.8976
      type: 'suite'
      ...
    1..3
ok 30 - Incremental Metrics Calculation (PERF-L2.2)
  ---
  duration_ms: 25.8178
  type: 'suite'
  ...
# Subtest: Kotlin Adapter
    # Subtest: ML-C2.1: Symbol Extraction
        # Subtest: should extract package declarations
        ok 1 - should extract package declarations
          ---
          duration_ms: 8.4595
          type: 'test'
          ...
        # Subtest: should extract class declarations
        ok 2 - should extract class declarations
          ---
          duration_ms: 4.3677
          type: 'test'
          ...
        # Subtest: should extract data class declarations
        ok 3 - should extract data class declarations
          ---
          duration_ms: 5.3377
          type: 'test'
          ...
        # Subtest: should extract open class declarations
        ok 4 - should extract open class declarations
          ---
          duration_ms: 4.1074
          type: 'test'
          ...
        # Subtest: should extract interface declarations
        ok 5 - should extract interface declarations
          ---
          duration_ms: 3.8402
          type: 'test'
          ...
        # Subtest: should extract object declarations
        ok 6 - should extract object declarations
          ---
          duration_ms: 4.7226
          type: 'test'
          ...
        # Subtest: should extract function declarations
        ok 7 - should extract function declarations
          ---
          duration_ms: 4.7099
          type: 'test'
          ...
        # Subtest: should extract method declarations
        ok 8 - should extract method declarations
          ---
          duration_ms: 3.8247
          type: 'test'
          ...
        # Subtest: should extract property declarations
        ok 9 - should extract property declarations
          ---
          duration_ms: 4.8994
          type: 'test'
          ...
        # Subtest: should extract secondary constructors
        ok 10 - should extract secondary constructors
          ---
          duration_ms: 2.7282
          type: 'test'
          ...
        # Subtest: should extract companion object constants
        ok 11 - should extract companion object constants
          ---
          duration_ms: 3.6585
          type: 'test'
          ...
        # Subtest: should extract generic type parameters
        ok 12 - should extract generic type parameters
          ---
          duration_ms: 3.98
          type: 'test'
          ...
        # Subtest: should extract visibility modifiers
        ok 13 - should extract visibility modifiers
          ---
          duration_ms: 4.4559
          type: 'test'
          ...
        # Subtest: should extract extension functions
        ok 14 - should extract extension functions
          ---
          duration_ms: 2.4732
          type: 'test'
          ...
        1..14
    ok 1 - ML-C2.1: Symbol Extraction
      ---
      duration_ms: 62.4307
      type: 'suite'
      ...
    # Subtest: ML-C2.2: Import Extraction
        # Subtest: should extract simple imports
        ok 1 - should extract simple imports
          ---
          duration_ms: 0.8724
          type: 'test'
          ...
        # Subtest: should extract aliased imports
        ok 2 - should extract aliased imports
          ---
          duration_ms: 0.6282
          type: 'test'
          ...
        # Subtest: should extract wildcard imports
        ok 3 - should extract wildcard imports
          ---
          duration_ms: 0.5892
          type: 'test'
          ...
        # Subtest: should identify external vs relative imports
        ok 4 - should identify external vs relative imports
          ---
          duration_ms: 0.5984
          type: 'test'
          ...
        1..4
    ok 2 - ML-C2.2: Import Extraction
      ---
      duration_ms: 2.7957
      type: 'suite'
      ...
    # Subtest: ML-C2.3: Call Extraction
        # Subtest: should extract simple function calls
        ok 1 - should extract simple function calls
          ---
          duration_ms: 17.1292
          type: 'test'
          ...
        # Subtest: should extract method calls on objects
        ok 2 - should extract method calls on objects
          ---
          duration_ms: 17.065
          type: 'test'
          ...
        # Subtest: should extract chained method calls
        ok 3 - should extract chained method calls
          ---
          duration_ms: 15.4245
          type: 'test'
          ...
        # Subtest: should extract companion object calls
        ok 4 - should extract companion object calls
          ---
          duration_ms: 15.2314
          type: 'test'
          ...
        # Subtest: should extract constructor calls
        ok 5 - should extract constructor calls
          ---
          duration_ms: 15.7271
          type: 'test'
          ...
        # Subtest: should extract extension function calls
        ok 6 - should extract extension function calls
          ---
          duration_ms: 16.9238
          type: 'test'
          ...
        # Subtest: should extract this.method calls
        ok 7 - should extract this.method calls
          ---
          duration_ms: 15.2506
          type: 'test'
          ...
        # Subtest: should extract nested function calls
        ok 8 - should extract nested function calls
          ---
          duration_ms: 15.9278
          type: 'test'
          ...
        # Subtest: should extract lambda calls
        ok 9 - should extract lambda calls
          ---
          duration_ms: 15.6914
          type: 'test'
          ...
        1..9
    ok 3 - ML-C2.3: Call Extraction
      ---
      duration_ms: 144.7051
      type: 'suite'
      ...
    # Subtest: ML-C2.4: Golden Files
        # Subtest: should match expected symbols output
        ok 1 - should match expected symbols output
          ---
          duration_ms: 5.1641
          type: 'test'
          ...
        # Subtest: should match expected imports output
        ok 2 - should match expected imports output
          ---
          duration_ms: 0.7312
          type: 'test'
          ...
        # Subtest: should match expected calls output
        ok 3 - should match expected calls output
          ---
          duration_ms: 15.7069
          type: 'test'
          ...
        1..3
    ok 4 - ML-C2.4: Golden Files
      ---
      duration_ms: 21.7667
      type: 'suite'
      ...
    # Subtest: Integration
        # Subtest: should handle complete Kotlin file with all constructs
        ok 1 - should handle complete Kotlin file with all constructs
          ---
          duration_ms: 13.2638
          type: 'test'
          ...
        1..1
    ok 5 - Integration
      ---
      duration_ms: 13.3435
      type: 'suite'
      ...
    # Subtest: Edge Cases
        # Subtest: should handle extension function call edge cases
        ok 1 - should handle extension function call edge cases
          ---
          duration_ms: 15.3558
          type: 'test'
          ...
        # Subtest: should handle constructor calls correctly
        ok 2 - should handle constructor calls correctly
          ---
          duration_ms: 15.4453
          type: 'test'
          ...
        # Subtest: should handle chained call edge cases
        ok 3 - should handle chained call edge cases
          ---
          duration_ms: 15.05
          type: 'test'
          ...
        1..3
    ok 6 - Edge Cases
      ---
      duration_ms: 45.9781
      type: 'suite'
      ...
    1..6
ok 31 - Kotlin Adapter
  ---
  duration_ms: 291.3982
  type: 'suite'
  ...
# Subtest: loadConfig environment path resolution
    # Subtest: uses SDL_CONFIG when no explicit configPath is provided
    ok 1 - uses SDL_CONFIG when no explicit configPath is provided
      ---
      duration_ms: 6.6829
      type: 'test'
      ...
    1..1
ok 32 - loadConfig environment path resolution
  ---
  duration_ms: 7.0648
  type: 'suite'
  ...
# Subtest: main stdio shutdown wiring
    # Subtest: unrefs cleanup interval so it cannot keep process alive
    ok 1 - unrefs cleanup interval so it cannot keep process alive
      ---
      duration_ms: 0.5113
      type: 'test'
      ...
    # Subtest: handles stdin end/close to trigger graceful shutdown
    ok 2 - handles stdin end/close to trigger graceful shutdown
      ---
      duration_ms: 0.2542
      type: 'test'
      ...
    1..2
ok 33 - main stdio shutdown wiring
  ---
  duration_ms: 1.2261
  type: 'suite'
  ...
# Subtest: IE-K.2: Path normalization in edge cleanup
    # Subtest: should handle relative paths with .. segments
    ok 1 - should handle relative paths with .. segments
      ---
      duration_ms: 0.6569
      type: 'test'
      ...
    # Subtest: should handle relative paths with multiple .. segments
    ok 2 - should handle relative paths with multiple .. segments
      ---
      duration_ms: 0.1246
      type: 'test'
      ...
    # Subtest: should try .tsx and .jsx extensions
    ok 3 - should try .tsx and .jsx extensions
      ---
      duration_ms: 0.0689
      type: 'test'
      ...
    # Subtest: should handle paths without extensions
    ok 4 - should handle paths without extensions
      ---
      duration_ms: 0.0595
      type: 'test'
      ...
    # Subtest: should handle index file resolution
    ok 5 - should handle index file resolution
      ---
      duration_ms: 0.0556
      type: 'test'
      ...
    # Subtest: should handle complex paths with .. and . segments
    ok 6 - should handle complex paths with .. and . segments
      ---
      duration_ms: 0.0655
      type: 'test'
      ...
    # Subtest: should remove duplicates from variants
    ok 7 - should remove duplicates from variants
      ---
      duration_ms: 0.0788
      type: 'test'
      ...
    # Subtest: should handle Windows path separators
    ok 8 - should handle Windows path separators
      ---
      duration_ms: 0.0726
      type: 'test'
      ...
    # Subtest: should preserve path normalization with .. that escape and re-enter
    ok 9 - should preserve path normalization with .. that escape and re-enter
      ---
      duration_ms: 0.107
      type: 'test'
      ...
    1..9
ok 34 - IE-K.2: Path normalization in edge cleanup
  ---
  duration_ms: 1.9747
  type: 'suite'
  ...
# Subtest: PHP Adapter
    # Subtest: ML-C2.1: Symbol Extraction
        # Subtest: should extract class declarations
        ok 1 - should extract class declarations
          ---
          duration_ms: 7.6428
          type: 'test'
          ...
        # Subtest: should extract interface declarations
        ok 2 - should extract interface declarations
          ---
          duration_ms: 2.401
          type: 'test'
          ...
        # Subtest: should extract trait declarations as class
        ok 3 - should extract trait declarations as class
          ---
          duration_ms: 3.2653
          type: 'test'
          ...
        # Subtest: should extract method declarations with visibility
        ok 4 - should extract method declarations with visibility
          ---
          duration_ms: 2.2646
          type: 'test'
          ...
        # Subtest: should extract method return types
        ok 5 - should extract method return types
          ---
          duration_ms: 3.4377
          type: 'test'
          ...
        # Subtest: should extract function declarations with namespace
        ok 6 - should extract function declarations with namespace
          ---
          duration_ms: 2.0783
          type: 'test'
          ...
        # Subtest: should mark private functions starting with underscore
        ok 7 - should mark private functions starting with underscore
          ---
          duration_ms: 2.9292
          type: 'test'
          ...
        # Subtest: should extract property declarations with visibility
        ok 8 - should extract property declarations with visibility
          ---
          duration_ms: 2.2134
          type: 'test'
          ...
        # Subtest: should extract const declarations
        ok 9 - should extract const declarations
          ---
          duration_ms: 2.1904
          type: 'test'
          ...
        # Subtest: should extract abstract and final class declarations
        ok 10 - should extract abstract and final class declarations
          ---
          duration_ms: 2.1759
          type: 'test'
          ...
        1..10
    ok 1 - ML-C2.1: Symbol Extraction
      ---
      duration_ms: 31.3713
      type: 'suite'
      ...
    # Subtest: ML-C2.2: Import Extraction
        # Subtest: should extract namespace use declarations
        ok 1 - should extract namespace use declarations
          ---
          duration_ms: 3.8684
          type: 'test'
          ...
        # Subtest: should extract use statements with aliases
        ok 2 - should extract use statements with aliases
          ---
          duration_ms: 2.9533
          type: 'test'
          ...
        # Subtest: should extract require statements
        ok 3 - should extract require statements
          ---
          duration_ms: 3.2917
          type: 'test'
          ...
        # Subtest: should identify relative paths in require/include
        ok 4 - should identify relative paths in require/include
          ---
          duration_ms: 3.0585
          type: 'test'
          ...
        # Subtest: should extract include statements
        ok 5 - should extract include statements
          ---
          duration_ms: 2.9717
          type: 'test'
          ...
        # Subtest: should handle absolute paths on Windows
        ok 6 - should handle absolute paths on Windows
          ---
          duration_ms: 4.2008
          type: 'test'
          ...
        # Subtest: should identify leading backslash as relative
        ok 7 - should identify leading backslash as relative
          ---
          duration_ms: 2.9494
          type: 'test'
          ...
        1..7
    ok 2 - ML-C2.2: Import Extraction
      ---
      duration_ms: 23.4917
      type: 'suite'
      ...
    # Subtest: ML-C2.3: Call Extraction
        # Subtest: should extract static method calls
        ok 1 - should extract static method calls
          ---
          duration_ms: 8.641
          type: 'test'
          ...
        # Subtest: should extract function calls
        ok 2 - should extract function calls
          ---
          duration_ms: 8.3037
          type: 'test'
          ...
        # Subtest: should mark dynamic calls as unresolved
        ok 3 - should mark dynamic calls as unresolved
          ---
          duration_ms: 8.7098
          type: 'test'
          ...
        # Subtest: should extract qualified namespace static calls
        ok 4 - should extract qualified namespace static calls
          ---
          duration_ms: 8.2316
          type: 'test'
          ...
        # Subtest: should extract multiple static calls in same function
        ok 5 - should extract multiple static calls in same function
          ---
          duration_ms: 8.5714
          type: 'test'
          ...
        # Subtest: should handle variable function name patterns
        ok 6 - should handle variable function name patterns
          ---
          duration_ms: 8.4317
          type: 'test'
          ...
        1..6
    ok 3 - ML-C2.3: Call Extraction
      ---
      duration_ms: 51.1203
      type: 'suite'
      ...
    # Subtest: ML-C2.4: Golden Files
        # Subtest: should match expected symbols output
        ok 1 - should match expected symbols output
          ---
          duration_ms: 2.1097
          type: 'test'
          ...
        # Subtest: should match expected imports output
        ok 2 - should match expected imports output
          ---
          duration_ms: 2.9377
          type: 'test'
          ...
        # Subtest: should match expected calls output
        ok 3 - should match expected calls output
          ---
          duration_ms: 8.2353
          type: 'test'
          ...
        1..3
    ok 4 - ML-C2.4: Golden Files
      ---
      duration_ms: 13.3999
      type: 'suite'
      ...
    # Subtest: Integration
        # Subtest: should handle complete PHP file with all constructs
        ok 1 - should handle complete PHP file with all constructs
          ---
          duration_ms: 8.8069
          type: 'test'
          ...
        1..1
    ok 5 - Integration
      ---
      duration_ms: 8.8902
      type: 'suite'
      ...
    1..5
ok 35 - PHP Adapter
  ---
  duration_ms: 128.6256
  type: 'suite'
  ...
# [INFO] All plugins unloaded {"count":0}
# [ERROR] Failed to load plugin {"path":"C:\\\\Users\\\\glitt\\\\AppData\\\\Local\\\\Temp\\\\vibe-kanban\\\\worktrees\\\\ff1e-v06-11-v0-6-inte\\\\sdl-mcp\\\\test-plugins\\\\valid-plugin.mjs","error":"Only URLs with a scheme in: file, data, and node are supported by the default ESM loader. On Windows, absolute paths must be valid file:// URLs. Received protocol 'c:'"}
# [INFO] All plugins unloaded {"count":0}
# [INFO] All plugins unloaded {"count":0}
# Subtest: Plugin Loader
    # Subtest: loadPlugin
        # Subtest: should load a valid plugin
        not ok 1 - should load a valid plugin
          ---
          duration_ms: 6.1315
          type: 'test'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-loader.test.ts:1:650'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            
            false !== true
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\plugin-loader.test.ts:66:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1442:7)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1442:7)
            async startSubtestAfterBootstrap (node:internal/test_runner/harness:296:3)
          ...
        # Subtest: should fail to load non-existent plugin
        ok 2 - should fail to load non-existent plugin
          ---
          duration_ms: 1.5159
          type: 'test'
          ...
# [ERROR] Failed to load plugin {"path":"C:\\\\Users\\\\glitt\\\\AppData\\\\Local\\\\Temp\\\\vibe-kanban\\\\worktrees\\\\ff1e-v06-11-v0-6-inte\\\\sdl-mcp\\\\test-plugins\\\\invalid-manifest.mjs","error":"Only URLs with a scheme in: file, data, and node are supported by the default ESM loader. On Windows, absolute paths must be valid file:// URLs. Received protocol 'c:'"}
# [INFO] All plugins unloaded {"count":0}
        # Subtest: should fail to load plugin with invalid manifest
        ok 3 - should fail to load plugin with invalid manifest
          ---
          duration_ms: 1.6834
          type: 'test'
          ...
# [ERROR] Failed to load plugin {"path":"C:\\\\Users\\\\glitt\\\\AppData\\\\Local\\\\Temp\\\\vibe-kanban\\\\worktrees\\\\ff1e-v06-11-v0-6-inte\\\\sdl-mcp\\\\test-plugins\\\\incompatible-version.mjs","error":"Only URLs with a scheme in: file, data, and node are supported by the default ESM loader. On Windows, absolute paths must be valid file:// URLs. Received protocol 'c:'"}
# [INFO] All plugins unloaded {"count":0}
        # Subtest: should fail to load plugin with incompatible API version
        not ok 4 - should fail to load plugin with incompatible API version
          ---
          duration_ms: 4.0061
          type: 'test'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-loader.test.ts:40:167'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\plugin-loader.test.ts:125:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
# [ERROR] Failed to load plugin {"path":"C:\\\\Users\\\\glitt\\\\AppData\\\\Local\\\\Temp\\\\vibe-kanban\\\\worktrees\\\\ff1e-v06-11-v0-6-inte\\\\sdl-mcp\\\\test-plugins\\\\invalid-structure.mjs","error":"Only URLs with a scheme in: file, data, and node are supported by the default ESM loader. On Windows, absolute paths must be valid file:// URLs. Received protocol 'c:'"}
# [INFO] All plugins unloaded {"count":0}
        # Subtest: should fail to load plugin with invalid module structure
        not ok 5 - should fail to load plugin with invalid module structure
          ---
          duration_ms: 3.2745
          type: 'test'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-loader.test.ts:53:206'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(result.errors.some((e) => e.includes("manifest")))
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\plugin-loader.test.ts:140:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        1..5
    not ok 1 - loadPlugin
      ---
      duration_ms: 17.3428
      type: 'suite'
      location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-loader.test.ts:1:623'
      failureType: 'subtestsFailed'
      error: '3 subtests failed'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        async Promise.all (index 0)
      ...
# [ERROR] Failed to load plugin {"path":"C:\\\\Users\\\\glitt\\\\AppData\\\\Local\\\\Temp\\\\vibe-kanban\\\\worktrees\\\\ff1e-v06-11-v0-6-inte\\\\sdl-mcp\\\\test-plugins\\\\plugin1.mjs","error":"Only URLs with a scheme in: file, data, and node are supported by the default ESM loader. On Windows, absolute paths must be valid file:// URLs. Received protocol 'c:'"}
# [ERROR] Failed to load plugin {"path":"C:\\\\Users\\\\glitt\\\\AppData\\\\Local\\\\Temp\\\\vibe-kanban\\\\worktrees\\\\ff1e-v06-11-v0-6-inte\\\\sdl-mcp\\\\test-plugins\\\\plugin2.mjs","error":"Only URLs with a scheme in: file, data, and node are supported by the default ESM loader. On Windows, absolute paths must be valid file:// URLs. Received protocol 'c:'"}
# [INFO] All plugins unloaded {"count":0}
    # Subtest: loadPluginsFromConfig
        # Subtest: should load multiple plugins successfully
        not ok 1 - should load multiple plugins successfully
          ---
          duration_ms: 3.0238
          type: 'test'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-loader.test.ts:55:230'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            
            0 !== 2
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 2
          actual: 0
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\plugin-loader.test.ts:189:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1442:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
# [ERROR] Failed to load plugin {"path":"C:\\\\Users\\\\glitt\\\\AppData\\\\Local\\\\Temp\\\\vibe-kanban\\\\worktrees\\\\ff1e-v06-11-v0-6-inte\\\\sdl-mcp\\\\test-plugins\\\\valid.mjs","error":"Only URLs with a scheme in: file, data, and node are supported by the default ESM loader. On Windows, absolute paths must be valid file:// URLs. Received protocol 'c:'"}
# [INFO] All plugins unloaded {"count":0}
# [INFO] All plugins unloaded {"count":0}
# [INFO] All plugins unloaded {"count":0}
        # Subtest: should handle mixed success and failure
        not ok 2 - should handle mixed success and failure
          ---
          duration_ms: 2.005
          type: 'test'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-loader.test.ts:84:259'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            
            0 !== 1
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 1
          actual: 0
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\plugin-loader.test.ts:219:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should return empty result when no plugin paths provided
        ok 3 - should return empty result when no plugin paths provided
          ---
          duration_ms: 0.8933
          type: 'test'
          ...
        # Subtest: should return empty result when empty array provided
        ok 4 - should return empty result when empty array provided
          ---
          duration_ms: 0.8601
          type: 'test'
          ...
        1..4
    not ok 2 - loadPluginsFromConfig
      ---
      duration_ms: 7.005
      type: 'suite'
      location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-loader.test.ts:55:192'
      failureType: 'subtestsFailed'
      error: '2 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
# [ERROR] Failed to load plugin {"path":"C:\\\\Users\\\\glitt\\\\AppData\\\\Local\\\\Temp\\\\vibe-kanban\\\\worktrees\\\\ff1e-v06-11-v0-6-inte\\\\sdl-mcp\\\\test-plugins\\\\adapters-plugin.mjs","error":"Only URLs with a scheme in: file, data, and node are supported by the default ESM loader. On Windows, absolute paths must be valid file:// URLs. Received protocol 'c:'"}
# [INFO] All plugins unloaded {"count":0}
    # Subtest: getPluginAdapters
        # Subtest: should return valid adapters from plugin
        not ok 1 - should return valid adapters from plugin
          ---
          duration_ms: 2.3959
          type: 'test'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-loader.test.ts:97:746'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(loadResult.loaded)
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\plugin-loader.test.ts:289:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1442:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
# [ERROR] Failed to load plugin {"path":"C:\\\\Users\\\\glitt\\\\AppData\\\\Local\\\\Temp\\\\vibe-kanban\\\\worktrees\\\\ff1e-v06-11-v0-6-inte\\\\sdl-mcp\\\\test-plugins\\\\invalid-adapter.mjs","error":"Only URLs with a scheme in: file, data, and node are supported by the default ESM loader. On Windows, absolute paths must be valid file:// URLs. Received protocol 'c:'"}
# [INFO] All plugins unloaded {"count":0}
        # Subtest: should throw error for invalid adapter structure
        not ok 2 - should throw error for invalid adapter structure
          ---
          duration_ms: 2.15
          type: 'test'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-loader.test.ts:140:324'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(loadResult.loaded)
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\plugin-loader.test.ts:321:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
# [ERROR] Failed to load plugin {"path":"C:\\\\Users\\\\glitt\\\\AppData\\\\Local\\\\Temp\\\\vibe-kanban\\\\worktrees\\\\ff1e-v06-11-v0-6-inte\\\\sdl-mcp\\\\test-plugins\\\\non-array-adapter.mjs","error":"Only URLs with a scheme in: file, data, and node are supported by the default ESM loader. On Windows, absolute paths must be valid file:// URLs. Received protocol 'c:'"}
# [INFO] All plugins unloaded {"count":0}
        # Subtest: should throw error if createAdapters returns non-array
        not ok 3 - should throw error if createAdapters returns non-array
          ---
          duration_ms: 1.906
          type: 'test'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-loader.test.ts:157:220'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(loadResult.loaded)
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\plugin-loader.test.ts:347:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        1..3
    not ok 3 - getPluginAdapters
      ---
      duration_ms: 6.6608
      type: 'suite'
      location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-loader.test.ts:97:712'
      failureType: 'subtestsFailed'
      error: '3 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
# [ERROR] Failed to load plugin {"path":"C:\\\\Users\\\\glitt\\\\AppData\\\\Local\\\\Temp\\\\vibe-kanban\\\\worktrees\\\\ff1e-v06-11-v0-6-inte\\\\sdl-mcp\\\\test-plugins\\\\track-plugin.mjs","error":"Only URLs with a scheme in: file, data, and node are supported by the default ESM loader. On Windows, absolute paths must be valid file:// URLs. Received protocol 'c:'"}
# [INFO] All plugins unloaded {"count":0}
    # Subtest: plugin lifecycle management
        # Subtest: should track loaded plugins
        not ok 1 - should track loaded plugins
          ---
          duration_ms: 2.0564
          type: 'test'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-loader.test.ts:170:271'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            
            false !== true
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\plugin-loader.test.ts:377:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1442:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
# [ERROR] Failed to load plugin {"path":"C:\\\\Users\\\\glitt\\\\AppData\\\\Local\\\\Temp\\\\vibe-kanban\\\\worktrees\\\\ff1e-v06-11-v0-6-inte\\\\sdl-mcp\\\\test-plugins\\\\unload-plugin.mjs","error":"Only URLs with a scheme in: file, data, and node are supported by the default ESM loader. On Windows, absolute paths must be valid file:// URLs. Received protocol 'c:'"}
# [INFO] All plugins unloaded {"count":0}
# [INFO] All plugins unloaded {"count":0}
        # Subtest: should unload plugin
        not ok 2 - should unload plugin
          ---
          duration_ms: 1.6769
          type: 'test'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-loader.test.ts:183:277'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            
            false !== true
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\plugin-loader.test.ts:402:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should return false when unloading non-existent plugin
        ok 3 - should return false when unloading non-existent plugin
          ---
          duration_ms: 0.8688
          type: 'test'
          ...
# [ERROR] Failed to load plugin {"path":"C:\\\\Users\\\\glitt\\\\AppData\\\\Local\\\\Temp\\\\vibe-kanban\\\\worktrees\\\\ff1e-v06-11-v0-6-inte\\\\sdl-mcp\\\\test-plugins\\\\clear1.mjs","error":"Only URLs with a scheme in: file, data, and node are supported by the default ESM loader. On Windows, absolute paths must be valid file:// URLs. Received protocol 'c:'"}
# [ERROR] Failed to load plugin {"path":"C:\\\\Users\\\\glitt\\\\AppData\\\\Local\\\\Temp\\\\vibe-kanban\\\\worktrees\\\\ff1e-v06-11-v0-6-inte\\\\sdl-mcp\\\\test-plugins\\\\clear2.mjs","error":"Only URLs with a scheme in: file, data, and node are supported by the default ESM loader. On Windows, absolute paths must be valid file:// URLs. Received protocol 'c:'"}
# [INFO] All plugins unloaded {"count":0}
        # Subtest: should clear all loaded plugins
        not ok 4 - should clear all loaded plugins
          ---
          duration_ms: 2.2298
          type: 'test'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-loader.test.ts:196:411'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            
            0 !== 2
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 2
          actual: 0
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\plugin-loader.test.ts:438:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        1..4
    not ok 4 - plugin lifecycle management
      ---
      duration_ms: 7.0472
      type: 'suite'
      location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-loader.test.ts:170:227'
      failureType: 'subtestsFailed'
      error: '3 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: getHostApiVersion
        # Subtest: should return a valid version string
        ok 1 - should return a valid version string
          ---
          duration_ms: 0.8066
          type: 'test'
          ...
        1..1
    ok 5 - getHostApiVersion
      ---
      duration_ms: 0.8538
      type: 'suite'
      ...
    1..5
not ok 36 - Plugin Loader
  ---
  duration_ms: 39.628
  type: 'suite'
  location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-loader.test.ts:1:423'
  failureType: 'subtestsFailed'
  error: '4 subtests failed'
  code: 'ERR_TEST_FAILURE'
  ...
# [ERROR] Failed to load plugin {"path":"C:\\\\Users\\\\glitt\\\\AppData\\\\Local\\\\Temp\\\\vibe-kanban\\\\worktrees\\\\ff1e-v06-11-v0-6-inte\\\\sdl-mcp\\\\test-registry-plugins\\\\registry-plugin.mjs","error":"Only URLs with a scheme in: file, data, and node are supported by the default ESM loader. On Windows, absolute paths must be valid file:// URLs. Received protocol 'c:'"}
# [WARN] 1 plugin(s) failed to load {"failedPlugins":[{"path":"C:\\\\Users\\\\glitt\\\\AppData\\\\Local\\\\Temp\\\\vibe-kanban\\\\worktrees\\\\ff1e-v06-11-v0-6-inte\\\\sdl-mcp\\\\test-registry-plugins\\\\registry-plugin.mjs","error":"Failed to load plugin: Only URLs with a scheme in: file, data, and node are supported by the default ESM loader. On Windows, absolute paths must be valid file:// URLs. Received protocol 'c:'"}]}
# Subtest: Registry with Plugin Integration
    # Subtest: plugin registration
        # Subtest: should register plugin adapters
        not ok 1 - should register plugin adapters
          ---
          duration_ms: 8.0436
          type: 'test'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-registry.test.ts:1:966'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(adapter)
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: ~
          operator: '=='
          stack: |-
            TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\plugin-registry.test.ts:71:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1442:7)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1442:7)
            async startSubtestAfterBootstrap (node:internal/test_runner/harness:296:3)
          ...
        # Subtest: should register multiple adapters from single plugin
        not ok 2 - should register multiple adapters from single plugin
          ---
          duration_ms: 2.5639
          type: 'test'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-registry.test.ts:30:203'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(getAdapterForExtension(".ext1"))
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: ~
          operator: '=='
          stack: |-
            TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\plugin-registry.test.ts:142:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should allow plugin to override built-in adapter
        not ok 3 - should allow plugin to override built-in adapter
          ---
          duration_ms: 1.6944
          type: 'test'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-registry.test.ts:87:374'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            + actual - expected
            
            + 'typescript'
            - 'custom-typescript'
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 'custom-typescript'
          actual: 'typescript'
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\plugin-registry.test.ts:191:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        1..3
    not ok 1 - plugin registration
      ---
      duration_ms: 12.8698
      type: 'suite'
      location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-registry.test.ts:1:930'
      failureType: 'subtestsFailed'
      error: '3 subtests failed'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        async Promise.all (index 0)
      ...
    # Subtest: getAdapterInfo
        # Subtest: should return info for built-in adapter
        ok 1 - should return info for built-in adapter
          ---
          duration_ms: 0.6647
          type: 'test'
          ...
        # Subtest: should return info for plugin adapter
        not ok 2 - should return info for plugin adapter
          ---
          duration_ms: 1.7269
          type: 'test'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-registry.test.ts:116:629'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            + actual - expected
            
            + null
            - 'info-lang'
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 'info-lang'
          actual: ~
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\plugin-registry.test.ts:246:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should return null info for unknown extension
        ok 3 - should return null info for unknown extension
          ---
          duration_ms: 0.6293
          type: 'test'
          ...
        1..3
    not ok 2 - getAdapterInfo
      ---
      duration_ms: 3.2291
      type: 'suite'
      location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-registry.test.ts:116:357'
      failureType: 'subtestsFailed'
      error: '1 subtest failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: getLanguageIdForExtension with plugins
        # Subtest: should return language ID for plugin adapter
        not ok 1 - should return language ID for plugin adapter
          ---
          duration_ms: 1.3734
          type: 'test'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-registry.test.ts:145:531'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            + actual - expected
            
            + null
            - 'test-lang-id'
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 'test-lang-id'
          actual: ~
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\plugin-registry.test.ts:297:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1442:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should return overridden language ID from plugin
        not ok 2 - should return overridden language ID from plugin
          ---
          duration_ms: 1.1979
          type: 'test'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-registry.test.ts:174:177'
          failureType: 'testCodeFailure'
          error: |-
            Expected values to be strictly equal:
            + actual - expected
            
            + 'typescript'
            - 'overridden-typescript'
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: 'overridden-typescript'
          actual: 'typescript'
          operator: 'strictEqual'
          stack: |-
            TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\plugin-registry.test.ts:341:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        1..2
    not ok 3 - getLanguageIdForExtension with plugins
      ---
      duration_ms: 2.7598
      type: 'suite'
      location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-registry.test.ts:145:476'
      failureType: 'subtestsFailed'
      error: '2 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: getSupportedExtensions with plugins
        # Subtest: should include plugin extensions
        not ok 1 - should include plugin extensions
          ---
          duration_ms: 1.5854
          type: 'test'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-registry.test.ts:203:256'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(extensions.includes(".supp1"))
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\plugin-registry.test.ts:397:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Promise.all (index 0)
            async Suite.run (node:internal/test_runner/test:1442:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        # Subtest: should include both built-in and plugin extensions
        not ok 2 - should include both built-in and plugin extensions
          ---
          duration_ms: 1.2966
          type: 'test'
          location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-registry.test.ts:246:207'
          failureType: 'testCodeFailure'
          error: |-
            The expression evaluated to a falsy value:
            
              assert.ok(extensions.includes(".pluginext"))
            
          code: 'ERR_ASSERTION'
          name: 'AssertionError'
          expected: true
          actual: false
          operator: '=='
          stack: |-
            TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\plugin-registry.test.ts:439:14)
            async Test.run (node:internal/test_runner/test:1054:7)
            async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
          ...
        1..2
    not ok 4 - getSupportedExtensions with plugins
      ---
      duration_ms: 2.9598
      type: 'suite'
      location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-registry.test.ts:203:204'
      failureType: 'subtestsFailed'
      error: '2 subtests failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: registerAdapter with source tracking
        # Subtest: should allow manual registration with source specified
        ok 1 - should allow manual registration with source specified
          ---
          duration_ms: 0.6122
          type: 'test'
          ...
        1..1
    ok 5 - registerAdapter with source tracking
      ---
      duration_ms: 0.6609
      type: 'suite'
      ...
    1..5
not ok 37 - Registry with Plugin Integration
  ---
  duration_ms: 22.9405
  type: 'suite'
  location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\plugin-registry.test.ts:1:628'
  failureType: 'subtestsFailed'
  error: '4 subtests failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: Plugin Types
    # Subtest: validateApiVersion
        # Subtest: should accept matching major versions
        ok 1 - should accept matching major versions
          ---
          duration_ms: 0.4591
          type: 'test'
          ...
        # Subtest: should reject mismatched major versions
        ok 2 - should reject mismatched major versions
          ---
          duration_ms: 0.1006
          type: 'test'
          ...
        # Subtest: should use host API version by default
        ok 3 - should use host API version by default
          ---
          duration_ms: 0.0468
          type: 'test'
          ...
        # Subtest: should reject zero major version
        ok 4 - should reject zero major version
          ---
          duration_ms: 0.0883
          type: 'test'
          ...
        1..4
    ok 1 - validateApiVersion
      ---
      duration_ms: 1.0505
      type: 'suite'
      ...
    # Subtest: validateManifest
        # Subtest: should validate a correct manifest
        ok 1 - should validate a correct manifest
          ---
          duration_ms: 0.8979
          type: 'test'
          ...
        # Subtest: should reject manifest with missing required fields
        ok 2 - should reject manifest with missing required fields
          ---
          duration_ms: 0.3873
          type: 'test'
          ...
        # Subtest: should reject manifest with invalid API version
        ok 3 - should reject manifest with invalid API version
          ---
          duration_ms: 0.1077
          type: 'test'
          ...
        # Subtest: should accept manifest with optional fields
        ok 4 - should accept manifest with optional fields
          ---
          duration_ms: 0.2196
          type: 'test'
          ...
        # Subtest: should reject manifest with invalid adapter structure
        ok 5 - should reject manifest with invalid adapter structure
          ---
          duration_ms: 0.6079
          type: 'test'
          ...
        # Subtest: should reject manifest with empty adapter array
        ok 6 - should reject manifest with empty adapter array
          ---
          duration_ms: 0.1951
          type: 'test'
          ...
        1..6
    ok 2 - validateManifest
      ---
      duration_ms: 2.6226
      type: 'suite'
      ...
    1..2
ok 38 - Plugin Types
  ---
  duration_ms: 3.9162
  type: 'suite'
  ...
# [ERROR] Policy rule "error-rule" evaluation failed {"error":{},"context":{"requestType":"symbolCard","repoId":"test-repo","symbolId":"test-symbol"}}
# [ERROR] Policy rule "error-rule" evaluation failed {"error":{},"context":{"requestType":"symbolCard","repoId":"test-repo","symbolId":"test-symbol"}}
# Subtest: Policy Engine - Window Size Limit Rule
    # Subtest: should approve request within default window limits when symbol in slice
    ok 1 - should approve request within default window limits when symbol in slice
      ---
      duration_ms: 1.1008
      type: 'test'
      ...
    # Subtest: should deny when maxWindowLines exceeds limit
    ok 2 - should deny when maxWindowLines exceeds limit
      ---
      duration_ms: 0.18
      type: 'test'
      ...
    # Subtest: should deny when maxWindowTokens exceeds limit
    ok 3 - should deny when maxWindowTokens exceeds limit
      ---
      duration_ms: 0.1647
      type: 'test'
      ...
    # Subtest: should skip rule for non-codeWindow requests
    ok 4 - should skip rule for non-codeWindow requests
      ---
      duration_ms: 0.1391
      type: 'test'
      ...
    # Subtest: should allow when maxWindowLines equals limit
    ok 5 - should allow when maxWindowLines equals limit
      ---
      duration_ms: 0.2064
      type: 'test'
      ...
    # Subtest: should allow when maxWindowTokens equals limit
    ok 6 - should allow when maxWindowTokens equals limit
      ---
      duration_ms: 0.1371
      type: 'test'
      ...
    1..6
ok 39 - Policy Engine - Window Size Limit Rule
  ---
  duration_ms: 2.9731
  type: 'suite'
  ...
# Subtest: Policy Engine - Identifiers Required Rule
    # Subtest: should downgrade when identifiers are provided but not in slice
    ok 1 - should downgrade when identifiers are provided but not in slice
      ---
      duration_ms: 0.1489
      type: 'test'
      ...
    # Subtest: should deny when identifiers missing but required
    ok 2 - should deny when identifiers missing but required
      ---
      duration_ms: 0.1242
      type: 'test'
      ...
    # Subtest: should deny when identifiersToFind is undefined
    ok 3 - should deny when identifiersToFind is undefined
      ---
      duration_ms: 0.1618
      type: 'test'
      ...
    # Subtest: should approve when identifiers not required by policy
    ok 4 - should approve when identifiers not required by policy
      ---
      duration_ms: 0.1676
      type: 'test'
      ...
    # Subtest: should skip rule for non-codeWindow requests
    ok 5 - should skip rule for non-codeWindow requests
      ---
      duration_ms: 0.0706
      type: 'test'
      ...
    # Subtest: should capture limited identifiers in evidence
    ok 6 - should capture limited identifiers in evidence
      ---
      duration_ms: 0.0923
      type: 'test'
      ...
    1..6
ok 40 - Policy Engine - Identifiers Required Rule
  ---
  duration_ms: 0.9155
  type: 'suite'
  ...
# Subtest: Policy Engine - Budget Caps Rule
    # Subtest: should approve when budget within limits
    ok 1 - should approve when budget within limits
      ---
      duration_ms: 0.0982
      type: 'test'
      ...
    # Subtest: should deny when maxCards exceeds limit
    ok 2 - should deny when maxCards exceeds limit
      ---
      duration_ms: 0.061
      type: 'test'
      ...
    # Subtest: should deny when maxEstimatedTokens exceeds limit
    ok 3 - should deny when maxEstimatedTokens exceeds limit
      ---
      duration_ms: 0.0529
      type: 'test'
      ...
    # Subtest: should skip rule for non-graphSlice requests
    ok 4 - should skip rule for non-graphSlice requests
      ---
      duration_ms: 0.057
      type: 'test'
      ...
    # Subtest: should skip rule when budget not provided
    ok 5 - should skip rule when budget not provided
      ---
      duration_ms: 0.0517
      type: 'test'
      ...
    # Subtest: should approve when budget at limits
    ok 6 - should approve when budget at limits
      ---
      duration_ms: 0.0448
      type: 'test'
      ...
    1..6
ok 41 - Policy Engine - Budget Caps Rule
  ---
  duration_ms: 0.4315
  type: 'suite'
  ...
# Subtest: Policy Engine - Break Glass Rule
    # Subtest: should trigger break glass with AUDIT keyword
    ok 1 - should trigger break glass with AUDIT keyword
      ---
      duration_ms: 0.1085
      type: 'test'
      ...
    # Subtest: should trigger break glass with BREAK-GLASS keyword
    ok 2 - should trigger break glass with BREAK-GLASS keyword
      ---
      duration_ms: 0.1006
      type: 'test'
      ...
    # Subtest: should be case-insensitive for break glass keywords
    ok 3 - should be case-insensitive for break glass keywords
      ---
      duration_ms: 0.0579
      type: 'test'
      ...
    # Subtest: should not trigger break glass without keyword
    ok 4 - should not trigger break glass without keyword
      ---
      duration_ms: 0.0539
      type: 'test'
      ...
    # Subtest: should approve when break glass disabled in config
    ok 5 - should approve when break glass disabled in config
      ---
      duration_ms: 0.0654
      type: 'test'
      ...
    1..5
ok 42 - Policy Engine - Break Glass Rule
  ---
  duration_ms: 0.443
  type: 'suite'
  ...
# Subtest: Policy Engine - Default Deny Raw Rule
    # Subtest: should deny raw code access by default
    ok 1 - should deny raw code access by default
      ---
      duration_ms: 0.0984
      type: 'test'
      ...
    # Subtest: should approve when symbol in slice context
    ok 2 - should approve when symbol in slice context
      ---
      duration_ms: 0.0829
      type: 'test'
      ...
    # Subtest: should approve when symbol in frontier
    ok 3 - should approve when symbol in frontier
      ---
      duration_ms: 0.06
      type: 'test'
      ...
    # Subtest: should downgrade to skeleton when no identifiers
    ok 4 - should downgrade to skeleton when no identifiers
      ---
      duration_ms: 0.0509
      type: 'test'
      ...
    # Subtest: should downgrade to hotpath when identifiers provided
    ok 5 - should downgrade to hotpath when identifiers provided
      ---
      duration_ms: 0.0464
      type: 'test'
      ...
    # Subtest: should allow raw when defaultDenyRaw is false
    ok 6 - should allow raw when defaultDenyRaw is false
      ---
      duration_ms: 0.0533
      type: 'test'
      ...
    # Subtest: should skip rule for non-codeWindow requests
    ok 7 - should skip rule for non-codeWindow requests
      ---
      duration_ms: 0.5172
      type: 'test'
      ...
    1..7
ok 43 - Policy Engine - Default Deny Raw Rule
  ---
  duration_ms: 0.988
  type: 'suite'
  ...
# Subtest: Policy Engine - Priority Evaluation
    # Subtest: should evaluate rules in priority order
    ok 1 - should evaluate rules in priority order
      ---
      duration_ms: 0.1076
      type: 'test'
      ...
    # Subtest: should stop evaluation at first deny if no downgrade
    ok 2 - should stop evaluation at first deny if no downgrade
      ---
      duration_ms: 0.0606
      type: 'test'
      ...
    # Subtest: should continue evaluating after downgrade suggestion
    ok 3 - should continue evaluating after downgrade suggestion
      ---
      duration_ms: 0.0494
      type: 'test'
      ...
    1..3
ok 44 - Policy Engine - Priority Evaluation
  ---
  duration_ms: 0.2614
  type: 'suite'
  ...
# Subtest: Policy Engine - Next Best Action
    # Subtest: should suggest skeleton for downgrade-to-skeleton
    ok 1 - should suggest skeleton for downgrade-to-skeleton
      ---
      duration_ms: 0.197
      type: 'test'
      ...
    # Subtest: should suggest hotpath for downgrade-to-hotpath
    ok 2 - should suggest hotpath for downgrade-to-hotpath
      ---
      duration_ms: 0.075
      type: 'test'
      ...
    # Subtest: should suggest increaseBudget for max-lines-exceeded
    ok 3 - should suggest increaseBudget for max-lines-exceeded
      ---
      duration_ms: 0.0551
      type: 'test'
      ...
    # Subtest: should suggest provideIdentifiersToFind for missing identifiers
    ok 4 - should suggest provideIdentifiersToFind for missing identifiers
      ---
      duration_ms: 0.0464
      type: 'test'
      ...
    # Subtest: should suggest narrowScope for max-cards-exceeded
    ok 5 - should suggest narrowScope for max-cards-exceeded
      ---
      duration_ms: 0.0751
      type: 'test'
      ...
    # Subtest: should suggest narrowScope for max-tokens-budget-exceeded
    ok 6 - should suggest narrowScope for max-tokens-budget-exceeded
      ---
      duration_ms: 0.0533
      type: 'test'
      ...
    # Subtest: should return no action for approved requests
    ok 7 - should return no action for approved requests
      ---
      duration_ms: 0.0437
      type: 'test'
      ...
    1..7
ok 45 - Policy Engine - Next Best Action
  ---
  duration_ms: 0.6192
  type: 'suite'
  ...
# Subtest: Policy Engine - Audit Trail
    # Subtest: should generate consistent hash for same inputs
    ok 1 - should generate consistent hash for same inputs
      ---
      duration_ms: 0.0541
      type: 'test'
      ...
    # Subtest: should generate different hashes for different decisions
    ok 2 - should generate different hashes for different decisions
      ---
      duration_ms: 0.0484
      type: 'test'
      ...
    # Subtest: should include audit hash in decision
    ok 3 - should include audit hash in decision
      ---
      duration_ms: 0.0361
      type: 'test'
      ...
    # Subtest: should capture all evidence in audit trail
    ok 4 - should capture all evidence in audit trail
      ---
      duration_ms: 0.0954
      type: 'test'
      ...
    # Subtest: should capture denied reasons when applicable
    ok 5 - should capture denied reasons when applicable
      ---
      duration_ms: 0.0407
      type: 'test'
      ...
    1..5
ok 46 - Policy Engine - Audit Trail
  ---
  duration_ms: 0.3276
  type: 'suite'
  ...
# Subtest: Policy Engine - Rule Management
    # Subtest: should add custom rule
    ok 1 - should add custom rule
      ---
      duration_ms: 0.1064
      type: 'test'
      ...
    # Subtest: should remove existing rule
    ok 2 - should remove existing rule
      ---
      duration_ms: 0.0413
      type: 'test'
      ...
    # Subtest: should get rule by name
    ok 3 - should get rule by name
      ---
      duration_ms: 0.0358
      type: 'test'
      ...
    # Subtest: should return undefined for non-existent rule
    ok 4 - should return undefined for non-existent rule
      ---
      duration_ms: 0.0371
      type: 'test'
      ...
    # Subtest: should respect disabled rule during evaluation
    ok 5 - should respect disabled rule during evaluation
      ---
      duration_ms: 0.058
      type: 'test'
      ...
    1..5
ok 47 - Policy Engine - Rule Management
  ---
  duration_ms: 0.3305
  type: 'suite'
  ...
# Subtest: Policy Engine - Configuration Management
    # Subtest: should update configuration
    ok 1 - should update configuration
      ---
      duration_ms: 0.0911
      type: 'test'
      ...
    # Subtest: should merge configuration updates
    ok 2 - should merge configuration updates
      ---
      duration_ms: 0.0432
      type: 'test'
      ...
    # Subtest: should return copy of configuration
    ok 3 - should return copy of configuration
      ---
      duration_ms: 0.0366
      type: 'test'
      ...
    # Subtest: should use updated configuration in evaluation
    ok 4 - should use updated configuration in evaluation
      ---
      duration_ms: 0.055
      type: 'test'
      ...
    1..4
ok 48 - Policy Engine - Configuration Management
  ---
  duration_ms: 0.2819
  type: 'suite'
  ...
# Subtest: Policy Engine - Error Handling
    # Subtest: should handle rule evaluation errors gracefully
    ok 1 - should handle rule evaluation errors gracefully
      ---
      duration_ms: 0.509
      type: 'test'
      ...
    # Subtest: should continue evaluation after error
    ok 2 - should continue evaluation after error
      ---
      duration_ms: 0.1144
      type: 'test'
      ...
    1..2
ok 49 - Policy Engine - Error Handling
  ---
  duration_ms: 0.6791
  type: 'suite'
  ...
# Subtest: Policy Engine - Edge Cases
    # Subtest: should handle empty context
    ok 1 - should handle empty context
      ---
      duration_ms: 0.0569
      type: 'test'
      ...
    # Subtest: should handle maximum budget values
    ok 2 - should handle maximum budget values
      ---
      duration_ms: 0.0636
      type: 'test'
      ...
    # Subtest: should handle zero values
    ok 3 - should handle zero values
      ---
      duration_ms: 0.0388
      type: 'test'
      ...
    # Subtest: should handle negative values
    ok 4 - should handle negative values
      ---
      duration_ms: 0.0312
      type: 'test'
      ...
    # Subtest: should handle very long reason strings
    ok 5 - should handle very long reason strings
      ---
      duration_ms: 0.0537
      type: 'test'
      ...
    # Subtest: should handle very large identifier arrays
    ok 6 - should handle very large identifier arrays
      ---
      duration_ms: 0.0951
      type: 'test'
      ...
    1..6
ok 50 - Policy Engine - Edge Cases
  ---
  duration_ms: 0.3982
  type: 'suite'
  ...
# Subtest: Policy Engine - Integration Tests
    # Subtest: should handle complex multi-rule scenarios
    ok 1 - should handle complex multi-rule scenarios
      ---
      duration_ms: 0.0721
      type: 'test'
      ...
    # Subtest: should work with symbol in slice context
    ok 2 - should work with symbol in slice context
      ---
      duration_ms: 0.0485
      type: 'test'
      ...
    # Subtest: should generate downgrade target with symbol info
    ok 3 - should generate downgrade target with symbol info
      ---
      duration_ms: 0.052
      type: 'test'
      ...
    1..3
ok 51 - Policy Engine - Integration Tests
  ---
  duration_ms: 0.2129
  type: 'suite'
  ...
# [INFO] PR Risk Analysis requested {"repoId":"test-repo","fromVersion":"v1","toVersion":"v2"}
# [INFO] PR Risk Analysis requested {"repoId":"test-repo","fromVersion":"v1","toVersion":"v2"}
# [INFO] PR Risk Analysis requested {"repoId":"test-repo","fromVersion":"v1","toVersion":"v2"}
# [INFO] PR Risk Analysis requested {"repoId":"test-repo","fromVersion":"v1","toVersion":"v2"}
# [INFO] PR Risk Analysis requested {"repoId":"test-repo","fromVersion":"v1","toVersion":"v2"}
# [INFO] PR Risk Analysis requested {"repoId":"test-repo","fromVersion":"v1","toVersion":"v2"}
# [INFO] PR Risk Analysis requested {"repoId":"test-repo","fromVersion":"v1","toVersion":"v2"}
# [INFO] PR Risk Analysis requested {"repoId":"test-repo","fromVersion":"nonexistent-v1","toVersion":"nonexistent-v2"}
# Subtest: PR Risk Analysis Tool
    # Subtest: should compute risk score for delta changes
    not ok 1 - should compute risk score for delta changes
      ---
      duration_ms: 8.1102
      type: 'test'
      location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\pr-risk-analysis.test.ts:1:171'
      failureType: 'testCodeFailure'
      error: 'Delta pack error: No symbol snapshots found for fromVersion v1. Run indexing to create snapshots.'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        handlePRRiskAnalysis (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\src\mcp\tools\prRisk.ts:32:11)
        TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\pr-risk-analysis.test.ts:15:28)
        Test.runInAsyncScope (node:async_hooks:214:14)
        Test.run (node:internal/test_runner/test:1047:25)
        Test.start (node:internal/test_runner/test:944:17)
        node:internal/test_runner/test:1440:71
        node:internal/per_context/primordials:464:82
        new Promise (<anonymous>)
        new SafePromise (node:internal/per_context/primordials:433:3)
        node:internal/per_context/primordials:464:9
      ...
    # Subtest: should return findings array with severity levels
    not ok 2 - should return findings array with severity levels
      ---
      duration_ms: 0.6016
      type: 'test'
      location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\pr-risk-analysis.test.ts:1:770'
      failureType: 'testCodeFailure'
      error: 'Delta pack error: No symbol snapshots found for fromVersion v1. Run indexing to create snapshots.'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        handlePRRiskAnalysis (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\src\mcp\tools\prRisk.ts:32:11)
        TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\pr-risk-analysis.test.ts:39:28)
        Test.runInAsyncScope (node:async_hooks:214:14)
        Test.run (node:internal/test_runner/test:1047:25)
        Suite.processPendingSubtests (node:internal/test_runner/test:744:18)
        Test.postRun (node:internal/test_runner/test:1173:19)
        Test.run (node:internal/test_runner/test:1101:12)
        async Promise.all (index 0)
        async Suite.run (node:internal/test_runner/test:1442:7)
        async startSubtestAfterBootstrap (node:internal/test_runner/harness:296:3)
      ...
    # Subtest: should return impactedSymbols from blast radius
    not ok 3 - should return impactedSymbols from blast radius
      ---
      duration_ms: 0.4671
      type: 'test'
      location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\pr-risk-analysis.test.ts:1:1408'
      failureType: 'testCodeFailure'
      error: 'Delta pack error: No symbol snapshots found for fromVersion v1. Run indexing to create snapshots.'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        handlePRRiskAnalysis (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\src\mcp\tools\prRisk.ts:32:11)
        TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\pr-risk-analysis.test.ts:68:28)
        Test.runInAsyncScope (node:async_hooks:214:14)
        Test.run (node:internal/test_runner/test:1047:25)
        Suite.processPendingSubtests (node:internal/test_runner/test:744:18)
        Test.postRun (node:internal/test_runner/test:1173:19)
        Test.run (node:internal/test_runner/test:1101:12)
        async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
      ...
    # Subtest: should return evidence array
    not ok 4 - should return evidence array
      ---
      duration_ms: 0.4324
      type: 'test'
      location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\pr-risk-analysis.test.ts:1:1684'
      failureType: 'testCodeFailure'
      error: 'Delta pack error: No symbol snapshots found for fromVersion v1. Run indexing to create snapshots.'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        handlePRRiskAnalysis (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\src\mcp\tools\prRisk.ts:32:11)
        TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\pr-risk-analysis.test.ts:83:28)
        Test.runInAsyncScope (node:async_hooks:214:14)
        Test.run (node:internal/test_runner/test:1047:25)
        Suite.processPendingSubtests (node:internal/test_runner/test:744:18)
        Test.postRun (node:internal/test_runner/test:1173:19)
        Test.run (node:internal/test_runner/test:1101:12)
        async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
      ...
    # Subtest: should return recommendedTests with priorities
    not ok 5 - should return recommendedTests with priorities
      ---
      duration_ms: 0.4941
      type: 'test'
      location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\pr-risk-analysis.test.ts:1:2155'
      failureType: 'testCodeFailure'
      error: 'Delta pack error: No symbol snapshots found for fromVersion v1. Run indexing to create snapshots.'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        handlePRRiskAnalysis (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\src\mcp\tools\prRisk.ts:32:11)
        TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\pr-risk-analysis.test.ts:108:28)
        Test.runInAsyncScope (node:async_hooks:214:14)
        Test.run (node:internal/test_runner/test:1047:25)
        Suite.processPendingSubtests (node:internal/test_runner/test:744:18)
        Test.postRun (node:internal/test_runner/test:1173:19)
        Test.run (node:internal/test_runner/test:1101:12)
        async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
      ...
    # Subtest: should set escalationRequired based on risk threshold
    not ok 6 - should set escalationRequired based on risk threshold
      ---
      duration_ms: 0.4039
      type: 'test'
      location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\pr-risk-analysis.test.ts:1:2872'
      failureType: 'testCodeFailure'
      error: 'Delta pack error: No symbol snapshots found for fromVersion v1. Run indexing to create snapshots.'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        handlePRRiskAnalysis (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\src\mcp\tools\prRisk.ts:32:11)
        TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\pr-risk-analysis.test.ts:142:28)
        Test.runInAsyncScope (node:async_hooks:214:14)
        Test.run (node:internal/test_runner/test:1047:25)
        Suite.processPendingSubtests (node:internal/test_runner/test:744:18)
        Test.postRun (node:internal/test_runner/test:1173:19)
        Test.run (node:internal/test_runner/test:1101:12)
        async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
      ...
    # Subtest: should include policyDecision when escalation required
    not ok 7 - should include policyDecision when escalation required
      ---
      duration_ms: 0.4015
      type: 'test'
      location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\pr-risk-analysis.test.ts:1:3182'
      failureType: 'testCodeFailure'
      error: 'Delta pack error: No symbol snapshots found for fromVersion v1. Run indexing to create snapshots.'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        handlePRRiskAnalysis (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\src\mcp\tools\prRisk.ts:32:11)
        TestContext.<anonymous> (C:\Users\glitt\AppData\Local\Temp\vibe-kanban\worktrees\ff1e-v06-11-v0-6-inte\sdl-mcp\tests\unit\pr-risk-analysis.test.ts:158:28)
        Test.runInAsyncScope (node:async_hooks:214:14)
        Test.run (node:internal/test_runner/test:1047:25)
        Suite.processPendingSubtests (node:internal/test_runner/test:744:18)
        Test.postRun (node:internal/test_runner/test:1173:19)
        Test.run (node:internal/test_runner/test:1101:12)
        async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
      ...
    # Subtest: should handle missing versions gracefully
    ok 8 - should handle missing versions gracefully
      ---
      duration_ms: 0.4447
      type: 'test'
      ...
    1..8
not ok 52 - PR Risk Analysis Tool
  ---
  duration_ms: 12.1156
  type: 'suite'
  location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\pr-risk-analysis.test.ts:1:133'
  failureType: 'subtestsFailed'
  error: '7 subtests failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: release regression guards
    # Subtest: parses card URI symbol segment correctly
    ok 1 - parses card URI symbol segment correctly
      ---
      duration_ms: 0.5989
      type: 'test'
      ...
    # Subtest: updates code policy engine from merged repo+app policy before evaluation
    ok 2 - updates code policy engine from merged repo+app policy before evaluation
      ---
      duration_ms: 0.2947
      type: 'test'
      ...
    # Subtest: uses absolute end line for code window truncation resume cursor
    ok 3 - uses absolute end line for code window truncation resume cursor
      ---
      duration_ms: 0.2487
      type: 'test'
      ...
    # Subtest: merges repo policy overrides in slice policy evaluation
    ok 4 - merges repo policy overrides in slice policy evaluation
      ---
      duration_ms: 0.2282
      type: 'test'
      ...
    # Subtest: policy get/set merges with app policy without clobbering overrides
    ok 5 - policy get/set merges with app policy without clobbering overrides
      ---
      duration_ms: 0.2467
      type: 'test'
      ...
    1..5
ok 53 - release regression guards
  ---
  duration_ms: 2.1473
  type: 'suite'
  ...
# Subtest: repo.register language defaults
    # Subtest: defaults to all supported languages when languages are omitted
    ok 1 - defaults to all supported languages when languages are omitted
      ---
      duration_ms: 0.331
      type: 'test'
      ...
    1..1
ok 54 - repo.register language defaults
  ---
  duration_ms: 0.7026
  type: 'suite'
  ...
# Subtest: Rust Adapter
    # Subtest: ML2-C3.2: Import Extraction
        # Subtest: should extract use statements with simple path
        ok 1 - should extract use statements with simple path
          ---
          duration_ms: 4.3533
          type: 'test'
          ...
        # Subtest: should extract wildcard imports
        ok 2 - should extract wildcard imports
          ---
          duration_ms: 0.8203
          type: 'test'
          ...
        # Subtest: should extract use statements with scoped list
        ok 3 - should extract use statements with scoped list
          ---
          duration_ms: 0.7039
          type: 'test'
          ...
        # Subtest: should extract use statements with aliases
        ok 4 - should extract use statements with aliases
          ---
          duration_ms: 0.7262
          type: 'test'
          ...
        # Subtest: should identify relative imports (self, super, crate)
        ok 5 - should identify relative imports (self, super, crate)
          ---
          duration_ms: 0.7545
          type: 'test'
          ...
        # Subtest: should extract module declarations (mod foo;)
        ok 6 - should extract module declarations (mod foo;)
          ---
          duration_ms: 0.7122
          type: 'test'
          ...
        # Subtest: should identify external crate uses
        ok 7 - should identify external crate uses
          ---
          duration_ms: 1.0637
          type: 'test'
          ...
        # Subtest: should extract re-exports
        ok 8 - should extract re-exports
          ---
          duration_ms: 0.8328
          type: 'test'
          ...
        # Subtest: should handle mixed use statements
        ok 9 - should handle mixed use statements
          ---
          duration_ms: 0.8203
          type: 'test'
          ...
        # Subtest: should match expected imports output
        ok 10 - should match expected imports output
          ---
          duration_ms: 0.91
          type: 'test'
          ...
        1..10
    ok 1 - ML2-C3.2: Import Extraction
      ---
      duration_ms: 13.1494
      type: 'suite'
      ...
    # Subtest: ML2-C3.1: Symbol Extraction
        # Subtest: should extract module declarations
        ok 1 - should extract module declarations
          ---
          duration_ms: 4.1356
          type: 'test'
          ...
        # Subtest: should extract functions with parameters and return types
        ok 2 - should extract functions with parameters and return types
          ---
          duration_ms: 2.9602
          type: 'test'
          ...
        # Subtest: should extract generic functions
        ok 3 - should extract generic functions
          ---
          duration_ms: 3.5978
          type: 'test'
          ...
        # Subtest: should extract structs with fields
        ok 4 - should extract structs with fields
          ---
          duration_ms: 2.4934
          type: 'test'
          ...
        # Subtest: should extract generic structs
        ok 5 - should extract generic structs
          ---
          duration_ms: 3.2341
          type: 'test'
          ...
        # Subtest: should extract enums with variants
        ok 6 - should extract enums with variants
          ---
          duration_ms: 2.9732
          type: 'test'
          ...
        # Subtest: should extract traits
        ok 7 - should extract traits
          ---
          duration_ms: 2.5827
          type: 'test'
          ...
        # Subtest: should extract impl block methods
        ok 8 - should extract impl block methods
          ---
          duration_ms: 3.8174
          type: 'test'
          ...
        # Subtest: should extract type aliases
        ok 9 - should extract type aliases
          ---
          duration_ms: 2.5014
          type: 'test'
          ...
        # Subtest: should extract visibility modifiers correctly
        ok 10 - should extract visibility modifiers correctly
          ---
          duration_ms: 2.5272
          type: 'test'
          ...
        1..10
    ok 2 - ML2-C3.1: Symbol Extraction
      ---
      duration_ms: 31.0632
      type: 'suite'
      ...
    # Subtest: ML2-C3.3: Call Extraction
        # Subtest: should extract simple function calls
        ok 1 - should extract simple function calls
          ---
          duration_ms: 10.4616
          type: 'test'
          ...
        # Subtest: should extract method calls with receiver
        ok 2 - should extract method calls with receiver
          ---
          duration_ms: 9.6376
          type: 'test'
          ...
        # Subtest: should extract associated function calls (Type::func)
        ok 3 - should extract associated function calls (Type::func)
          ---
          duration_ms: 9.7496
          type: 'test'
          ...
        # Subtest: should extract chained method calls
        ok 4 - should extract chained method calls
          ---
          duration_ms: 11.3273
          type: 'test'
          ...
        # Subtest: should extract macro invocations as unresolved
        ok 5 - should extract macro invocations as unresolved
          ---
          duration_ms: 8.7181
          type: 'test'
          ...
        # Subtest: should extract module-qualified calls
        ok 6 - should extract module-qualified calls
          ---
          duration_ms: 8.7134
          type: 'test'
          ...
        # Subtest: should track caller context for calls
        ok 7 - should track caller context for calls
          ---
          duration_ms: 9.7697
          type: 'test'
          ...
        1..7
    ok 3 - ML2-C3.3: Call Extraction
      ---
      duration_ms: 68.6294
      type: 'suite'
      ...
    # Subtest: ML2-C3.4: Golden Files
        # Subtest: should match expected symbols output
        ok 1 - should match expected symbols output
          ---
          duration_ms: 2.8959
          type: 'test'
          ...
        # Subtest: should match expected imports output
        ok 2 - should match expected imports output
          ---
          duration_ms: 0.8674
          type: 'test'
          ...
        # Subtest: should match expected calls output
        ok 3 - should match expected calls output
          ---
          duration_ms: 11.7205
          type: 'test'
          ...
        1..3
    ok 4 - ML2-C3.4: Golden Files
      ---
      duration_ms: 15.6036
      type: 'suite'
      ...
    # Subtest: Integration
        # Subtest: should handle complete Rust file with all constructs
        ok 1 - should handle complete Rust file with all constructs
          ---
          duration_ms: 4.9272
          type: 'test'
          ...
        1..1
    ok 5 - Integration
      ---
      duration_ms: 4.9956
      type: 'suite'
      ...
    1..5
ok 55 - Rust Adapter
  ---
  duration_ms: 133.8048
  type: 'suite'
  ...
# Subtest: Shell Adapter
    # Subtest: ML2-C5.1: Symbol Extraction
        # Subtest: should extract function definitions with name() style
        ok 1 - should extract function definitions with name() style
          ---
          duration_ms: 4.375
          type: 'test'
          ...
        # Subtest: should extract function definitions with function keyword style
        ok 2 - should extract function definitions with function keyword style
          ---
          duration_ms: 1.4458
          type: 'test'
          ...
        # Subtest: should extract function definitions with parameters in body
        ok 3 - should extract function definitions with parameters in body
          ---
          duration_ms: 1.9908
          type: 'test'
          ...
        # Subtest: should extract global variables
        ok 4 - should extract global variables
          ---
          duration_ms: 1.3553
          type: 'test'
          ...
        # Subtest: should extract exported variables
        ok 5 - should extract exported variables
          ---
          duration_ms: 1.3883
          type: 'test'
          ...
        # Subtest: should extract readonly variables
        ok 6 - should extract readonly variables
          ---
          duration_ms: 1.4298
          type: 'test'
          ...
        # Subtest: should extract array variables
        ok 7 - should extract array variables
          ---
          duration_ms: 1.31
          type: 'test'
          ...
        # Subtest: should extract associative array variables
        ok 8 - should extract associative array variables
          ---
          duration_ms: 1.4039
          type: 'test'
          ...
        # Subtest: should extract local variables inside functions
        ok 9 - should extract local variables inside functions
          ---
          duration_ms: 1.9023
          type: 'test'
          ...
        # Subtest: should extract aliases as variables
        ok 10 - should extract aliases as variables
          ---
          duration_ms: 2.7169
          type: 'test'
          ...
        # Subtest: should extract functions with multiple variable reassignments
        ok 11 - should extract functions with multiple variable reassignments
          ---
          duration_ms: 1.2508
          type: 'test'
          ...
        1..11
    ok 1 - ML2-C5.1: Symbol Extraction
      ---
      duration_ms: 21.3341
      type: 'suite'
      ...
    # Subtest: ML2-C5.2: Import Extraction
        # Subtest: should extract source commands with relative paths
        ok 1 - should extract source commands with relative paths
          ---
          duration_ms: 4.5905
          type: 'test'
          ...
        # Subtest: should extract source commands with absolute paths
        ok 2 - should extract source commands with absolute paths
          ---
          duration_ms: 4.0633
          type: 'test'
          ...
        # Subtest: should extract dot notation source commands
        ok 3 - should extract dot notation source commands
          ---
          duration_ms: 4.3172
          type: 'test'
          ...
        # Subtest: should extract source with parent directory relative paths
        ok 4 - should extract source with parent directory relative paths
          ---
          duration_ms: 4.0462
          type: 'test'
          ...
        # Subtest: should extract source with nested relative paths
        ok 5 - should extract source with nested relative paths
          ---
          duration_ms: 3.9387
          type: 'test'
          ...
        # Subtest: should strip quotes from file paths
        ok 6 - should strip quotes from file paths
          ---
          duration_ms: 4.0021
          type: 'test'
          ...
        # Subtest: should handle multiple source commands
        ok 7 - should handle multiple source commands
          ---
          duration_ms: 4.5602
          type: 'test'
          ...
        1..7
    ok 2 - ML2-C5.2: Import Extraction
      ---
      duration_ms: 29.7155
      type: 'suite'
      ...
    # Subtest: ML2-C5.3: Call Extraction
        # Subtest: should extract function calls inside function bodies
        ok 1 - should extract function calls inside function bodies
          ---
          duration_ms: 5.4879
          type: 'test'
          ...
        # Subtest: should extract function calls with correct resolution
        ok 2 - should extract function calls with correct resolution
          ---
          duration_ms: 4.8302
          type: 'test'
          ...
        # Subtest: should identify external commands as dynamic calls
        ok 3 - should identify external commands as dynamic calls
          ---
          duration_ms: 5.4194
          type: 'test'
          ...
        # Subtest: should identify alias invocations as dynamic calls
        ok 4 - should identify alias invocations as dynamic calls
          ---
          duration_ms: 4.9522
          type: 'test'
          ...
        # Subtest: should extract calls with arguments
        ok 5 - should extract calls with arguments
          ---
          duration_ms: 5.0273
          type: 'test'
          ...
        # Subtest: should extract function calls in command substitution
        ok 6 - should extract function calls in command substitution
          ---
          duration_ms: 5.9915
          type: 'test'
          ...
        # Subtest: should extract calls in pipelines
        ok 7 - should extract calls in pipelines
          ---
          duration_ms: 4.6914
          type: 'test'
          ...
        # Subtest: should extract calls in subshells
        ok 8 - should extract calls in subshells
          ---
          duration_ms: 4.7767
          type: 'test'
          ...
        # Subtest: should extract calls in conditional statements
        ok 9 - should extract calls in conditional statements
          ---
          duration_ms: 5.1713
          type: 'test'
          ...
        # Subtest: should skip source commands (not function calls)
        ok 10 - should skip source commands (not function calls)
          ---
          duration_ms: 4.9277
          type: 'test'
          ...
        # Subtest: should skip alias definitions (not function calls)
        ok 11 - should skip alias definitions (not function calls)
          ---
          duration_ms: 4.9919
          type: 'test'
          ...
        # Subtest: should correctly identify caller for calls in global scope
        ok 12 - should correctly identify caller for calls in global scope
          ---
          duration_ms: 4.7815
          type: 'test'
          ...
        1..12
    ok 3 - ML2-C5.3: Call Extraction
      ---
      duration_ms: 61.3815
      type: 'suite'
      ...
    # Subtest: ML2-C5.4: Golden Files
        # Subtest: should match expected symbols output
        ok 1 - should match expected symbols output
          ---
          duration_ms: 1.225
          type: 'test'
          ...
        # Subtest: should match expected imports output
        ok 2 - should match expected imports output
          ---
          duration_ms: 4.4567
          type: 'test'
          ...
        # Subtest: should match expected calls output
        ok 3 - should match expected calls output
          ---
          duration_ms: 4.6926
          type: 'test'
          ...
        1..3
    ok 4 - ML2-C5.4: Golden Files
      ---
      duration_ms: 10.4818
      type: 'suite'
      ...
    # Subtest: Integration
        # Subtest: should handle complete Shell file with all constructs
        ok 1 - should handle complete Shell file with all constructs
          ---
          duration_ms: 7.1197
          type: 'test'
          ...
        1..1
    ok 5 - Integration
      ---
      duration_ms: 7.1757
      type: 'suite'
      ...
    # Subtest: Command Substitution Edge Cases
        # Subtest: should handle nested command substitution
        ok 1 - should handle nested command substitution
          ---
          duration_ms: 4.8551
          type: 'test'
          ...
        # Subtest: should handle command substitution with pipelines
        ok 2 - should handle command substitution with pipelines
          ---
          duration_ms: 3.3381
          type: 'test'
          ...
        # Subtest: should handle backtick command substitution
        ok 3 - should handle backtick command substitution
          ---
          duration_ms: 3.2683
          type: 'test'
          ...
        1..3
    ok 6 - Command Substitution Edge Cases
      ---
      duration_ms: 11.54
      type: 'suite'
      ...
    1..6
ok 56 - Shell Adapter
  ---
  duration_ms: 142.025
  type: 'suite'
  ...
# Subtest: Symbol References (Inverted Index)
    # Subtest: should insert and retrieve symbol references
    ok 1 - should insert and retrieve symbol references
      ---
      duration_ms: 1.2243
      type: 'test'
      ...
    # Subtest: should return empty array for non-existent symbol
    ok 2 - should return empty array for non-existent symbol
      ---
      duration_ms: 0.3997
      type: 'test'
      ...
    # Subtest: should delete references by file ID
    ok 3 - should delete references by file ID
      ---
      duration_ms: 0.2004
      type: 'test'
      ...
    # Subtest: should handle duplicate symbol names correctly
    ok 4 - should handle duplicate symbol names correctly
      ---
      duration_ms: 0.1887
      type: 'test'
      ...
    1..4
ok 57 - Symbol References (Inverted Index)
  ---
  duration_ms: 10.3209
  type: 'suite'
  ...
# node:internal/modules/run_main:123
#     triggerUncaughtException(
#     ^
# Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'vitest' imported from C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\sync-artifact.test.ts
#     at Object.getPackageJSONURL (node:internal/modules/package_json_reader:314:9)
#     at packageResolve (node:internal/modules/esm/resolve:767:81)
#     at moduleResolve (node:internal/modules/esm/resolve:853:18)
#     at defaultResolve (node:internal/modules/esm/resolve:983:11)
#     at nextResolve (node:internal/modules/esm/hooks:748:28)
#     at resolveBase (file:///C:/Users/glitt/AppData/Local/Temp/vibe-kanban/worktrees/ff1e-v06-11-v0-6-inte/sdl-mcp/node_modules/tsx/dist/esm/index.mjs?1770592260928:2:3744)
#     at resolveDirectory (file:///C:/Users/glitt/AppData/Local/Temp/vibe-kanban/worktrees/ff1e-v06-11-v0-6-inte/sdl-mcp/node_modules/tsx/dist/esm/index.mjs?1770592260928:2:4243)
#     at resolveTsPaths (file:///C:/Users/glitt/AppData/Local/Temp/vibe-kanban/worktrees/ff1e-v06-11-v0-6-inte/sdl-mcp/node_modules/tsx/dist/esm/index.mjs?1770592260928:2:4984)
#     at resolve (file:///C:/Users/glitt/AppData/Local/Temp/vibe-kanban/worktrees/ff1e-v06-11-v0-6-inte/sdl-mcp/node_modules/tsx/dist/esm/index.mjs?1770592260928:2:5361)
#     at nextResolve (node:internal/modules/esm/hooks:748:28) {
#   code: 'ERR_MODULE_NOT_FOUND'
# }
# Node.js v22.21.1
# Subtest: C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\sync-artifact.test.ts
not ok 43 - C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\sync-artifact.test.ts
  ---
  duration_ms: 128.7026
  type: 'test'
  location: 'C:\\Users\\glitt\\AppData\\Local\\Temp\\vibe-kanban\\worktrees\\ff1e-v06-11-v0-6-inte\\sdl-mcp\\tests\\unit\\sync-artifact.test.ts:1:1'
  failureType: 'testCodeFailure'
  exitCode: 1
  signal: ~
  error: 'test failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: MCP tool registration
    # Subtest: registers sdl.slice.refresh
    ok 1 - registers sdl.slice.refresh
      ---
      duration_ms: 0.3601
      type: 'test'
      ...
    1..1
ok 59 - MCP tool registration
  ---
  duration_ms: 0.7296
  type: 'suite'
  ...
# Subtest: TypeScriptAdapter async methods
    # Subtest: parseAsync should return the same result as parse
    ok 1 - parseAsync should return the same result as parse
      ---
      duration_ms: 4.442
      type: 'test'
      ...
    # Subtest: extractAll should return tree, symbols, imports, and calls
    ok 2 - extractAll should return tree, symbols, imports, and calls
      ---
      duration_ms: 51.1729
      type: 'test'
      ...
    # Subtest: extractAll should extract symbols correctly
    ok 3 - extractAll should extract symbols correctly
      ---
      duration_ms: 49.2672
      type: 'test'
      ...
    # Subtest: extractAll should handle parse errors gracefully
    ok 4 - extractAll should handle parse errors gracefully
      ---
      duration_ms: 48.6465
      type: 'test'
      ...
    # Subtest: extractAll should bundle all extraction steps
    ok 5 - extractAll should bundle all extraction steps
      ---
      duration_ms: 49.4595
      type: 'test'
      ...
    1..5
ok 60 - TypeScriptAdapter async methods
  ---
  duration_ms: 203.6566
  type: 'suite'
  ...
# Subtest: TypeScript Symbol Extraction (IE-K.1)
    # Subtest: should extract exported type aliases
    ok 1 - should extract exported type aliases
      ---
      duration_ms: 15.861
      type: 'test'
      ...
    # Subtest: should extract exported interfaces
    ok 2 - should extract exported interfaces
      ---
      duration_ms: 0.5001
      type: 'test'
      ...
    # Subtest: should mark non-exported types with exported: false
    ok 3 - should mark non-exported types with exported: false
      ---
      duration_ms: 0.9644
      type: 'test'
      ...
    # Subtest: should extract type aliases with generics
    ok 4 - should extract type aliases with generics
      ---
      duration_ms: 0.8204
      type: 'test'
      ...
    # Subtest: should extract interfaces with generics and inheritance
    ok 5 - should extract interfaces with generics and inheritance
      ---
      duration_ms: 0.3502
      type: 'test'
      ...
    # Subtest: should extract mixed exports (functions, classes, types, interfaces)
    ok 6 - should extract mixed exports (functions, classes, types, interfaces)
      ---
      duration_ms: 0.8669
      type: 'test'
      ...
    1..6
ok 61 - TypeScript Symbol Extraction (IE-K.1)
  ---
  duration_ms: 19.8984
  type: 'suite'
  ...
1..61
# tests 641
# suites 192
# pass 595
# fail 46
# cancelled 0
# skipped 0
# todo 0
# duration_ms 10317.2197
